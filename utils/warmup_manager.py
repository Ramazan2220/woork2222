#!/usr/bin/env python3
# -*- coding: utf-8 -*-

"""
–ú–µ–Ω–µ–¥–∂–µ—Ä –ø—Ä–æ–≥—Ä–µ–≤–∞ –∞–∫–∫–∞—É–Ω—Ç–æ–≤ Instagram

–†–ê–ù–î–û–ú–ò–ó–ê–¶–ò–Ø –î–ï–ô–°–¢–í–ò–ô:
======================
–°–∏—Å—Ç–µ–º–∞ –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ –∏–º–∏—Ç–∏—Ä—É–µ—Ç —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–µ –ø–æ–≤–µ–¥–µ–Ω–∏–µ —á–µ—Ä–µ–∑:

1. –í–†–ï–ú–ï–ù–ù–ê–Ø –†–ê–ù–î–û–ú–ò–ó–ê–¶–ò–Ø:
   - –°–ª—É—á–∞–π–Ω—ã–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏ (3-120 —Å–µ–∫)
   - –î–ª–∏–Ω–Ω—ã–µ –ø–∞—É–∑—ã (15% —à–∞–Ω—Å –Ω–∞ 2-4x —É–≤–µ–ª–∏—á–µ–Ω–∏–µ –∑–∞–¥–µ—Ä–∂–∫–∏)
   - –ë—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (10% —à–∞–Ω—Å –Ω–∞ 0.3x —É–º–µ–Ω—å—à–µ–Ω–∏–µ)
   - –û—Ç–¥—ã—Ö –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏ (5-60 –º–∏–Ω—É—Ç)
   - –î–ª–∏–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ä—ã–≤—ã (30 –º–∏–Ω—É—Ç - 2 —á–∞—Å–∞)

2. –ü–û–°–õ–ï–î–û–í–ê–¢–ï–õ–¨–ù–û–°–¢–¨ –î–ï–ô–°–¢–í–ò–ô:
   - –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä –∏–∑ –ø—Ä–µ–¥—É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–Ω—ã—Ö –ø–∞—Ç—Ç–µ—Ä–Ω–æ–≤
   - –ê–¥–∞–ø—Ç–∞—Ü–∏—è –ø–æ–¥ –≤—Ä–µ–º—è –¥–Ω—è (—É—Ç—Ä–æ/–¥–µ–Ω—å/–≤–µ—á–µ—Ä)
   - –ü–µ—Ä–µ–º–µ—à–∏–≤–∞–Ω–∏–µ –ø–æ—Ä—è–¥–∫–∞ –¥–µ–π—Å—Ç–≤–∏–π
   - –°–ª—É—á–∞–π–Ω—ã–µ –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç–∏ —Å–µ—Å—Å–∏–π

3. –ö–û–õ–ò–ß–ï–°–¢–í–ï–ù–ù–ê–Ø –†–ê–ù–î–û–ú–ò–ó–ê–¶–ò–Ø:
   - –°–ª—É—á–∞–π–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π –≤ –¥–∏–∞–ø–∞–∑–æ–Ω–µ (min-max)
   - –í–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å ¬±20% –æ—Ç –±–∞–∑–æ–≤—ã—Ö –∑–Ω–∞—á–µ–Ω–∏–π
   - –†–∞–∑–Ω—ã–µ –ª–∏–º–∏—Ç—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö —Ä–µ–∂–∏–º–æ–≤ –ø—Ä–æ–≥—Ä–µ–≤–∞

4. –ü–û–í–ï–î–ï–ù–ß–ï–°–ö–ê–Ø –†–ê–ù–î–û–ú–ò–ó–ê–¶–ò–Ø:
   - –°–ª—É—á–∞–π–Ω—ã–π –≤—ã–±–æ—Ä —Ü–µ–ª–µ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
   - –°–ª—É—á–∞–π–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–∑ –±–∞–∑—ã
   - –°–ª—É—á–∞–π–Ω—ã–µ —Ä–µ–∞–∫—Ü–∏–∏ –Ω–∞ –∏—Å—Ç–æ—Ä–∏–∏
   - –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–≤–ª–µ—á–µ–Ω–∏–π (10% —à–∞–Ω—Å –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ—Å—Å–∏—é)

5. –ß–ï–õ–û–í–ï–ß–ï–°–ö–ò–ï –ü–ê–¢–¢–ï–†–ù–´:
   - –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –¥–Ω–µ–º (9:00-23:00)
   - –ü–∏–∫–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ 12-13, 19-21
   - –†–∞–∑–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –ø–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–Ω—è
   - –ï—Å—Ç–µ—Å—Ç–≤–µ–Ω–Ω—ã–µ –ø–µ—Ä–µ—Ä—ã–≤—ã –∏ –ø–∞—É–∑—ã
"""

import logging
import random
import time
from datetime import datetime, timedelta
from typing import Dict, List, Optional
from enum import Enum

logger = logging.getLogger(__name__)

class WarmupSpeed(Enum):
    SLOW = "SLOW"
    NORMAL = "NORMAL"
    FAST = "FAST"
    SUPER_FAST = "SUPER_FAST"
    DAILY = "DAILY"

class HumanBehaviorManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è"""
    
    # –ü–∞—Ç—Ç–µ—Ä–Ω—ã —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è –¥–ª—è –∫–∞–∂–¥–æ–≥–æ —Ä–µ–∂–∏–º–∞
    BEHAVIOR_PATTERNS = {
        'SLOW': {
            'session_duration': (10, 20),  # –º–∏–Ω—É—Ç—ã
            'break_duration': (15, 60),    # –º–∏–Ω—É—Ç—ã –º–µ–∂–¥—É —Å–µ—Å—Å–∏—è–º–∏
            'actions_per_session': (3, 8),
            'sequences': [
                ['view_feed', 'like_posts', 'rest'],
                ['view_stories', 'view_profiles', 'rest'],
                ['follow', 'view_profiles', 'like_posts', 'rest'],
                ['save_posts', 'view_feed', 'rest'],
                ['watch_reels', 'like_posts', 'long_rest']
            ]
        },
        'NORMAL': {
            'session_duration': (15, 30),
            'break_duration': (10, 40),
            'actions_per_session': (5, 12),
            'sequences': [
                ['view_feed', 'like_posts', 'follow', 'rest'],
                ['view_stories', 'comment', 'rest'],
                ['post_story', 'watch_reels', 'rest'],
                ['like_posts', 'save_posts', 'rest'],
                ['explore_hashtags', 'follow', 'like_posts', 'long_rest']
            ]
        },
        'FAST': {
            'session_duration': (20, 40),
            'break_duration': (8, 25),
            'actions_per_session': (8, 18),
            'sequences': [
                ['like_posts', 'like_posts', 'follow', 'follow', 'rest'],
                ['comment', 'view_stories', 'rest'],
                ['post_story', 'watch_reels', 'rest'],
                ['watch_reels', 'like_posts', 'save_posts', 'rest'],
                ['explore_hashtags', 'follow', 'like_posts', 'comment', 'long_rest']
            ]
        },
        'SUPER_FAST': {
            'session_duration': (25, 45),
            'break_duration': (5, 15),
            'actions_per_session': (12, 25),
            'sequences': [
                ['like_posts', 'like_posts', 'like_posts', 'follow', 'follow', 'rest'],
                ['comment', 'comment', 'post_story', 'rest'],
                ['like_posts', 'follow', 'watch_reels', 'rest'],
                ['watch_reels', 'like_posts', 'save_posts', 'comment', 'rest']
            ]
        },
        'DAILY': {
            'session_duration': (15, 25),
            'break_duration': (15, 30),
            'actions_per_session': (6, 15),
            'sequences': [
                # –£—Ç—Ä–µ–Ω–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                ['view_feed', 'like_posts', 'like_posts', 'follow', 'rest'],
                # –î–Ω–µ–≤–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å  
                ['comment', 'view_stories', 'rest'],
                # –í–µ—á–µ—Ä–Ω—è—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
                ['post_story', 'watch_reels', 'rest']
            ]
        }
    }
    
    # –í–µ—Å–∞ –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è —Ä–∞–∑–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏ –¥–Ω—è
    TIME_BASED_WEIGHTS = {
        'morning': {  # 9-12
            'view_feed': 1.5,
            'view_stories': 1.3,
            'like_posts': 1.2,
            'follow': 0.8,
            'comment': 0.5,
            'post_story': 0.3
        },
        'afternoon': {  # 12-17
            'view_feed': 1.0,
            'like_posts': 1.0,
            'follow': 1.2,
            'comment': 1.0,
            'watch_reels': 1.3,
            'explore_hashtags': 1.2
        },
        'evening': {  # 17-23
            'view_stories': 1.4,
            'like_posts': 1.1,
            'comment': 1.3,
            'post_story': 1.5,
            'send_messages': 1.2,
            'save_posts': 1.1
        }
    }
    
    def __init__(self, warmup_speed: str = 'NORMAL'):
        self.warmup_speed = warmup_speed
        self.last_action_time = None
        self.session_start_time = None
        self.actions_in_session = 0
        
    def get_time_period(self) -> str:
        """–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å –ø–µ—Ä–∏–æ–¥ –¥–Ω—è"""
        hour = datetime.now().hour
        if 9 <= hour < 12:
            return 'morning'
        elif 12 <= hour < 17:
            return 'afternoon'
        elif 17 <= hour <= 23:
            return 'evening'
        else:
            return 'night'
    
    def should_start_session(self) -> bool:
        """–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —Å—Ç–æ–∏—Ç –ª–∏ –Ω–∞—á–∏–Ω–∞—Ç—å –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é"""
        current_time = datetime.now()
        
        # –ù–µ —Ä–∞–±–æ—Ç–∞–µ–º –Ω–æ—á—å—é
        if current_time.hour < 9 or current_time.hour > 23:
            return False
        
        # –ï—Å–ª–∏ —ç—Ç–æ –ø–µ—Ä–≤–∞—è —Å–µ—Å—Å–∏—è
        if self.last_action_time is None:
            return True
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –ø—Ä–æ—à–ª–æ –ª–∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω–æ –≤—Ä–µ–º–µ–Ω–∏ —Å –ø–æ—Å–ª–µ–¥–Ω–µ–π —Å–µ—Å—Å–∏–∏
        pattern = self.BEHAVIOR_PATTERNS[self.warmup_speed]
        min_break, max_break = pattern['break_duration']
        
        time_since_last = (current_time - self.last_action_time).total_seconds() / 60
        
        # –î–ª—è –ø–µ—Ä–≤—ã—Ö –∑–∞–ø—É—Å–∫–æ–≤ –¥–µ–ª–∞–µ–º –º–µ–Ω—å—à–∏–µ –∏–Ω—Ç–µ—Ä–≤–∞–ª—ã
        if time_since_last < 5:  # –ï—Å–ª–∏ –ø—Ä–æ—à–ª–æ –º–µ–Ω—å—à–µ 5 –º–∏–Ω—É—Ç
            required_break = random.randint(2, 5)  # –ö–æ—Ä–æ—Ç–∫–∏–π –ø–µ—Ä–µ—Ä—ã–≤
        else:
            required_break = random.randint(min_break, max_break)
        
        should_start = time_since_last >= required_break
        
        if should_start:
            logger.info(f"‚úÖ –í—Ä–µ–º—è –¥–ª—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ (–ø—Ä–æ—à–ª–æ {time_since_last:.1f} –º–∏–Ω)")
        else:
            logger.info(f"‚è≥ –ñ–¥–µ–º –µ—â–µ {required_break - time_since_last:.1f} –º–∏–Ω –¥–æ —Å–ª–µ–¥—É—é—â–µ–π —Å–µ—Å—Å–∏–∏")
        
        return should_start
    
    def should_end_session(self) -> bool:
        """–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å, —Å—Ç–æ–∏—Ç –ª–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Ç–µ–∫—É—â—É—é —Å–µ—Å—Å–∏—é"""
        if self.session_start_time is None:
            return True
        
        pattern = self.BEHAVIOR_PATTERNS[self.warmup_speed]
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Å–µ—Å—Å–∏–∏
        session_duration = (datetime.now() - self.session_start_time).total_seconds() / 60
        min_duration, max_duration = pattern['session_duration']
        max_session_duration = random.randint(min_duration, max_duration)
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π
        min_actions, max_actions = pattern['actions_per_session']
        max_session_actions = random.randint(min_actions, max_actions)
        
        # –ó–∞–≤–µ—Ä—à–∞–µ–º —Å–µ—Å—Å–∏—é –µ—Å–ª–∏ –ø—Ä–µ–≤—ã—à–µ–Ω—ã –ª–∏–º–∏—Ç—ã
        if session_duration >= max_session_duration or self.actions_in_session >= max_session_actions:
            return True
        
        # –ò–Ω–æ–≥–¥–∞ –∑–∞–≤–µ—Ä—à–∞–µ–º —Å–µ—Å—Å–∏—é —Å–ª—É—á–∞–π–Ω–æ (—á–µ–ª–æ–≤–µ–∫ –æ—Ç–≤–ª–µ–∫—Å—è)
        if random.random() < 0.1:  # 10% —à–∞–Ω—Å
            return True
        
        return False
    
    def get_next_action_sequence(self) -> List[str]:
        """–ü–æ–ª—É—á–∏—Ç—å —Å–ª–µ–¥—É—é—â—É—é –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π"""
        pattern = self.BEHAVIOR_PATTERNS[self.warmup_speed]
        sequence = random.choice(pattern['sequences'])
        
        # –ê–¥–∞–ø—Ç–∏—Ä—É–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –ø–æ–¥ –≤—Ä–µ–º—è –¥–Ω—è
        time_period = self.get_time_period()
        if time_period == 'night':
            return []
        
        # –§–∏–ª—å—Ç—Ä—É–µ–º –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ –æ—Å–Ω–æ–≤–µ –≤—Ä–µ–º–µ–Ω–∏ –¥–Ω—è
        filtered_sequence = []
        for action in sequence:
            if action in ['rest', 'long_rest']:
                filtered_sequence.append(action)
                continue
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –≤–µ—Å –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Ç–µ–∫—É—â–µ–≥–æ –≤—Ä–µ–º–µ–Ω–∏
            weight = self.TIME_BASED_WEIGHTS.get(time_period, {}).get(action, 1.0)
            
            # –î–æ–±–∞–≤–ª—è–µ–º –¥–µ–π—Å—Ç–≤–∏–µ —Å —É—á–µ—Ç–æ–º –≤–µ—Å–∞
            if random.random() < weight:
                filtered_sequence.append(action)
        
        return filtered_sequence
    
    def get_action_delay(self, action_type: str, is_rest: bool = False) -> int:
        """–ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –¥–ª—è –¥–µ–π—Å—Ç–≤–∏—è —Å —É—á–µ—Ç–æ–º —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è"""
        if is_rest:
            if action_type == 'long_rest':
                return random.randint(1800, 7200)  # 30 –º–∏–Ω—É—Ç - 2 —á–∞—Å–∞
            else:  # –æ–±—ã—á–Ω—ã–π rest
                return random.randint(300, 1800)   # 5-30 –º–∏–Ω—É—Ç
        
        # –ë–∞–∑–æ–≤—ã–µ –∑–∞–¥–µ—Ä–∂–∫–∏ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏ (–≤ —Å–µ–∫—É–Ω–¥–∞—Ö)
        base_delays = {
            'view_feed': (10, 30),
            'view_stories': (5, 15),
            'view_profiles': (8, 25),
            'like_posts': (3, 12),
            'follow': (15, 45),
            'comment': (30, 90),
            'save_posts': (5, 20),
            'post_story': (60, 180),
            'post_photo': (120, 300),
            'watch_reels': (20, 60),
            'explore_hashtags': (15, 40),
            'send_messages': (45, 120),
            'update_profile': (60, 180),
        }
        
        min_delay, max_delay = base_delays.get(action_type, (10, 30))
        
        # –î–æ–±–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ä–µ–∂–∏–º–∞
        speed_multipliers = {
            'SLOW': 2.0,
            'NORMAL': 1.0,
            'FAST': 0.7,
            'SUPER_FAST': 0.4,
            'DAILY': 1.0
        }
        
        multiplier = speed_multipliers.get(self.warmup_speed, 1.0)
        min_delay = int(min_delay * multiplier)
        max_delay = int(max_delay * multiplier)
        
        delay = random.randint(min_delay, max_delay)
        
        # –î–æ–±–∞–≤–ª—è–µ–º —á–µ–ª–æ–≤–µ—á–µ—Å–∫—É—é –Ω–µ–ø—Ä–µ–¥—Å–∫–∞–∑—É–µ–º–æ—Å—Ç—å
        if random.random() < 0.15:  # 15% —à–∞–Ω—Å –Ω–∞ –¥–ª–∏–Ω–Ω—É—é –ø–∞—É–∑—É
            delay *= random.randint(2, 4)
        
        # –ò–Ω–æ–≥–¥–∞ –æ—á–µ–Ω—å –±—ã—Å—Ç—Ä—ã–µ –¥–µ–π—Å—Ç–≤–∏—è (—á–µ–ª–æ–≤–µ–∫ —Å–æ—Å—Ä–µ–¥–æ—Ç–æ—á–µ–Ω)
        elif random.random() < 0.1:  # 10% —à–∞–Ω—Å
            delay = int(delay * 0.3)
        
        return max(delay, 2)  # –ú–∏–Ω–∏–º—É–º 2 —Å–µ–∫—É–Ω–¥—ã
    
    def start_session(self):
        """–ù–∞—á–∞—Ç—å –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é"""
        self.session_start_time = datetime.now()
        self.actions_in_session = 0
        logger.info(f"üé¨ –ù–∞—á–∏–Ω–∞–µ–º –Ω–æ–≤—É—é —Å–µ—Å—Å–∏—é –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ ({self.warmup_speed})")
    
    def end_session(self):
        """–ó–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ—Å—Å–∏—é"""
        if self.session_start_time:
            duration = (datetime.now() - self.session_start_time).total_seconds() / 60
            logger.info(f"üèÅ –°–µ—Å—Å–∏—è –∑–∞–≤–µ—Ä—à–µ–Ω–∞. –î–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {duration:.1f} –º–∏–Ω, –¥–µ–π—Å—Ç–≤–∏–π: {self.actions_in_session}")
        
        self.session_start_time = None
        self.actions_in_session = 0
        self.last_action_time = datetime.now()
    
    def record_action(self, action_type: str):
        """–ó–∞–ø–∏—Å–∞—Ç—å –≤—ã–ø–æ–ª–Ω–µ–Ω–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ"""
        self.actions_in_session += 1
        logger.info(f"üìä –î–µ–π—Å—Ç–≤–∏–µ {self.actions_in_session} –≤ —Å–µ—Å—Å–∏–∏: {action_type}")

class WarmupManager:
    """–ú–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –ø—Ä–æ–≥—Ä–µ–≤–æ–º –∞–∫–∫–∞—É–Ω—Ç–æ–≤"""
    
    # –§–∞–∑—ã –ø—Ä–æ–≥—Ä–µ–≤–∞ —Å –ø–æ—Å—Ç–µ–ø–µ–Ω–Ω—ã–º —É–≤–µ–ª–∏—á–µ–Ω–∏–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏
    # –ú–æ–∂–Ω–æ –≤—ã–±—Ä–∞—Ç—å —Å–∫–æ—Ä–æ—Å—Ç—å –ø—Ä–æ–≥—Ä–µ–≤–∞: SLOW, NORMAL, FAST
    WARMUP_SPEEDS = {
        'SLOW': {  # ~21 –¥–µ–Ω—å - –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π –±–µ–∑–æ–ø–∞—Å–Ω–æ—Å—Ç–∏
            'phase1': 3, 'phase2': 3, 'phase3': 5, 'phase4': 5, 'phase5': 5
        },
        'NORMAL': {  # ~14 –¥–Ω–µ–π - –æ–ø—Ç–∏–º–∞–ª—å–Ω—ã–π –±–∞–ª–∞–Ω—Å
            'phase1': 2, 'phase2': 2, 'phase3': 3, 'phase4': 3, 'phase5': 4
        },
        'FAST': {  # ~7 –¥–Ω–µ–π - –¥–ª—è –æ–ø—ã—Ç–Ω—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –∏–ª–∏ —Å—Ä–æ—á–Ω—ã—Ö –∑–∞–¥–∞—á
            'phase1': 1, 'phase2': 1, 'phase3': 2, 'phase4': 2, 'phase5': 1
        },
        'SUPER_FAST': {  # ~3 –¥–Ω—è - –∞–≥—Ä–µ—Å—Å–∏–≤–Ω—ã–π —Ä–µ–∂–∏–º
            'phase1': 1, 'phase2': 1, 'phase3': 1, 'phase4': 0, 'phase5': 0
        },
        'DAILY': {  # ~1 –¥–µ–Ω—å - —Ç–µ—Å—Ç–æ–≤—ã–π —Ä–µ–∂–∏–º
            'phase1': 0.3, 'phase2': 0.3, 'phase3': 0.2, 'phase4': 0.2, 'phase5': 0
        }
    }
    
    WARMUP_PHASES = {
        'phase1': {
            'name': '–ù–∞—á–∞–ª—å–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            'duration_days': 2,
            'actions': {
                'view_feed': {'min': 5, 'max': 10},
                'view_stories': {'min': 3, 'max': 8},
                'view_profiles': {'min': 2, 'max': 5},
                'like_posts': {'min': 5, 'max': 10},
                'explore_hashtags': {'min': 1, 'max': 3},
            }
        },
        'phase2': {
            'name': '–ë–∞–∑–æ–≤–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            'duration_days': 2,
            'actions': {
                'view_feed': {'min': 10, 'max': 20},
                'view_stories': {'min': 5, 'max': 15},
                'view_profiles': {'min': 5, 'max': 10},
                'like_posts': {'min': 10, 'max': 20},
                'follow': {'min': 3, 'max': 5},
                'save_posts': {'min': 2, 'max': 5},
                'watch_reels': {'min': 3, 'max': 8},
                'explore_hashtags': {'min': 2, 'max': 5},
            }
        },
        'phase3': {
            'name': '–†–∞—Å—à–∏—Ä–µ–Ω–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            'duration_days': 3,
            'actions': {
                'view_feed': {'min': 20, 'max': 30},
                'view_stories': {'min': 10, 'max': 20},
                'view_profiles': {'min': 10, 'max': 15},
                'like_posts': {'min': 15, 'max': 30},
                'follow': {'min': 5, 'max': 10},
                'comment': {'min': 2, 'max': 5},
                'save_posts': {'min': 5, 'max': 10},
                'watch_reels': {'min': 5, 'max': 15},
                'explore_hashtags': {'min': 3, 'max': 8},
                'send_messages': {'min': 1, 'max': 3},
            }
        },
        'phase4': {
            'name': '–ê–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å',
            'duration_days': 3,
            'actions': {
                'view_feed': {'min': 30, 'max': 50},
                'view_stories': {'min': 15, 'max': 30},
                'view_profiles': {'min': 15, 'max': 25},
                'like_posts': {'min': 25, 'max': 50},
                'follow': {'min': 10, 'max': 20},
                'comment': {'min': 5, 'max': 10},
                'save_posts': {'min': 10, 'max': 20},
                'post_story': {'min': 1, 'max': 2},
                'watch_reels': {'min': 10, 'max': 25},
                'explore_hashtags': {'min': 5, 'max': 10},
                'send_messages': {'min': 2, 'max': 5},
                'update_profile': {'min': 0, 'max': 1},
            }
        },
        'phase5': {
            'name': '–ü–æ–ª–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å',
            'duration_days': 4,
            'actions': {
                'view_feed': {'min': 50, 'max': 100},
                'view_stories': {'min': 20, 'max': 50},
                'view_profiles': {'min': 20, 'max': 40},
                'like_posts': {'min': 50, 'max': 100},
                'follow': {'min': 20, 'max': 50},
                'comment': {'min': 10, 'max': 20},
                'save_posts': {'min': 15, 'max': 30},
                'post_story': {'min': 1, 'max': 3},
                'post_photo': {'min': 0, 'max': 1},
                'watch_reels': {'min': 20, 'max': 40},
                'explore_hashtags': {'min': 10, 'max': 20},
                'send_messages': {'min': 3, 'max': 10},
                'update_profile': {'min': 0, 'max': 1},
            }
        }
    }
    
    def __init__(self, account_id: int, client, warmup_speed: str = 'NORMAL'):
        self.account_id = account_id
        self.client = client
        self.current_phase = None
        self.phase_start_date = None
        self.daily_actions = {}
        self.total_actions = {}
        self.warmup_speed = warmup_speed if warmup_speed in self.WARMUP_SPEEDS else 'NORMAL'
        self.behavior_manager = HumanBehaviorManager(warmup_speed)
        
        # –°—á–µ—Ç—á–∏–∫–∏ –¥–µ–π—Å—Ç–≤–∏–π –¥–ª—è —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏
        self.session_stats = {
            'likes': 0,
            'follows': 0,
            'comments': 0,
            'saves': 0,
            'stories': 0,
            'posts': 0
        }
        
        # ID —Ç–µ–∫—É—â–µ–π –∑–∞–¥–∞—á–∏ –ø—Ä–æ–≥—Ä–µ–≤–∞
        self.task_id = None
        
        # –°–∏—Å—Ç–µ–º–∞ –ø—Ä–æ–≥—Ä–µ–≤–∞ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º
        self.interest_warmup = None
    
    def set_task_id(self, task_id: int):
        """–£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å ID –∑–∞–¥–∞—á–∏ –ø—Ä–æ–≥—Ä–µ–≤–∞"""
        self.task_id = task_id
    
    def setup_interest_warmup(self, interests_config: dict):
        """–ù–∞—Å—Ç—Ä–æ–∏—Ç—å –ø—Ä–æ–≥—Ä–µ–≤ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º"""
        try:
            from utils.interest_based_warmup import InterestBasedWarmup
            
            # –ò–∑–≤–ª–µ–∫–∞–µ–º –∏–Ω—Ç–µ—Ä–µ—Å—ã –∏–∑ –∫–æ–Ω—Ñ–∏–≥–∞
            primary_interests = interests_config.get('primary_interests', [])
            secondary_interests = interests_config.get('secondary_interests', [])
            custom_hashtags = interests_config.get('custom_hashtags', [])
            custom_accounts = interests_config.get('custom_accounts', [])
            
            if primary_interests:
                # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å –∏–Ω—Ç–µ—Ä–µ—Å–æ–≤
                interest_profile = InterestBasedWarmup.create_interest_profile(
                    primary_interests=primary_interests,
                    secondary_interests=secondary_interests,
                    custom_hashtags=custom_hashtags,
                    custom_accounts=custom_accounts
                )
                
                # –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º —Å–∏—Å—Ç–µ–º—É –ø—Ä–æ–≥—Ä–µ–≤–∞ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º
                self.interest_warmup = InterestBasedWarmup(
                    account_id=self.account_id,
                    client=self.client,
                    interest_profile=interest_profile
                )
                
                logger.info(f"‚úÖ –ù–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ–≥—Ä–µ–≤ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º: {', '.join(primary_interests)}")
                return True
            else:
                logger.warning("‚ö†Ô∏è –ù–µ —É–∫–∞–∑–∞–Ω—ã –æ—Å–Ω–æ–≤–Ω—ã–µ –∏–Ω—Ç–µ—Ä–µ—Å—ã –¥–ª—è –ø—Ä–æ–≥—Ä–µ–≤–∞")
                return False
                
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–æ–≥—Ä–µ–≤–∞ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º: {e}")
            return False
    
    def update_task_progress(self, action_type: str = None):
        """–û–±–Ω–æ–≤–∏—Ç—å –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞—á–∏ –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö"""
        if not self.task_id:
            return
        
        try:
            from database.db_manager import get_session
            from database.models import WarmupTask
            import json
            
            session = get_session()
            task = session.query(WarmupTask).filter_by(id=self.task_id).first()
            
            if task:
                # –ó–∞–≥—Ä—É–∂–∞–µ–º —Ç–µ–∫—É—â–∏–π –ø—Ä–æ–≥—Ä–µ—Å—Å –∏–ª–∏ —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π
                progress = task.progress or {}
                
                # –û–±–Ω–æ–≤–ª—è–µ–º –æ–±—â–∏–µ —Å—á–µ—Ç—á–∏–∫–∏
                progress['likes_given'] = progress.get('likes_given', 0) + self.session_stats['likes']
                progress['follows_made'] = progress.get('follows_made', 0) + self.session_stats['follows']
                progress['comments_made'] = progress.get('comments_made', 0) + self.session_stats['comments']
                progress['posts_saved'] = progress.get('posts_saved', 0) + self.session_stats['saves']
                progress['stories_created'] = progress.get('stories_created', 0) + self.session_stats['stories']
                progress['posts_created'] = progress.get('posts_created', 0) + self.session_stats['posts']
                
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º —Ç–µ–∫—É—â—É—é —Ñ–∞–∑—É
                if hasattr(self, 'current_phase'):
                    progress['current_phase'] = self.current_phase
                
                # –°–æ—Ö—Ä–∞–Ω—è–µ–º –ø–æ—Å–ª–µ–¥–Ω–µ–µ –¥–µ–π—Å—Ç–≤–∏–µ
                if action_type:
                    progress['last_action'] = action_type
                    progress['last_action_time'] = datetime.now().isoformat()
                
                # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
                task.progress = progress
                task.updated_at = datetime.now()
                session.commit()
                
                logger.debug(f"‚úÖ –û–±–Ω–æ–≤–ª–µ–Ω –ø—Ä–æ–≥—Ä–µ—Å—Å –∑–∞–¥–∞—á–∏ #{self.task_id}: {progress}")
                
            session.close()
            
        except Exception as e:
            logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ–≥—Ä–µ—Å—Å–∞: {e}")
    
    def get_phase_duration(self, phase_name: str) -> int:
        """–ü–æ–ª—É—á–∏—Ç—å –¥–ª–∏—Ç–µ–ª—å–Ω–æ—Å—Ç—å —Ñ–∞–∑—ã –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å–∫–æ—Ä–æ—Å—Ç–∏ –ø—Ä–æ–≥—Ä–µ–≤–∞"""
        return self.WARMUP_SPEEDS[self.warmup_speed].get(phase_name, 
                                                         self.WARMUP_PHASES[phase_name]['duration_days'])
        
    def get_current_phase(self, start_date: datetime) -> str:
        """–û–ø—Ä–µ–¥–µ–ª–∏—Ç—å —Ç–µ–∫—É—â—É—é —Ñ–∞–∑—É –ø—Ä–æ–≥—Ä–µ–≤–∞"""
        days_passed = (datetime.now() - start_date).days
        
        total_days = 0
        for phase_name in ['phase1', 'phase2', 'phase3', 'phase4', 'phase5']:
            phase_duration = self.get_phase_duration(phase_name)
            total_days += phase_duration
            if days_passed < total_days:
                return phase_name
        
        return 'completed'
    
    def should_perform_action(self) -> bool:
        """–ü—Ä–æ–≤–µ—Ä–∏—Ç—å, –Ω—É–∂–Ω–æ –ª–∏ –≤—ã–ø–æ–ª–Ω—è—Ç—å –¥–µ–π—Å—Ç–≤–∏–µ —Å–µ–π—á–∞—Å"""
        current_hour = datetime.now().hour
        
        # –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å —Ç–æ–ª—å–∫–æ –≤ –¥–Ω–µ–≤–Ω–æ–µ –≤—Ä–µ–º—è (9:00 - 23:00)
        if current_hour < 9 or current_hour > 23:
            return False
        
        # –ü–∏–∫ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–Ω—ã–µ —á–∞—Å—ã
        peak_hours = [12, 13, 19, 20, 21]
        if current_hour in peak_hours:
            return random.random() < 0.8  # 80% —à–∞–Ω—Å
        
        # –û–±—ã—á–Ω–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
        return random.random() < 0.5  # 50% —à–∞–Ω—Å
    
    def get_action_delay(self, action_type: str) -> int:
        """–ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–µ—Ä–∂–∫—É –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏"""
        base_delays = {
            'view_feed': (3, 10),
            'view_stories': (2, 5),
            'view_profiles': (5, 15),
            'like_posts': (2, 8),
            'follow': (30, 120),
            'comment': (60, 180),
            'save_posts': (10, 30),
            'post_story': (300, 600),
            'post_photo': (600, 1200),
            'watch_reels': (15, 60),
            'explore_hashtags': (10, 30),
            'send_messages': (120, 300),
            'update_profile': (300, 600),
        }
        
        min_delay, max_delay = base_delays.get(action_type, (30, 120))
        
        # –î–æ–±–∞–≤–ª—è–µ–º —Å–ª—É—á–∞–π–Ω–æ—Å—Ç—å –¥–ª—è –∏–º–∏—Ç–∞—Ü–∏–∏ —á–µ–ª–æ–≤–µ–∫–∞
        delay = random.randint(min_delay, max_delay)
        
        # –ò–Ω–æ–≥–¥–∞ –¥–µ–ª–∞–µ–º –¥–ª–∏–Ω–Ω—ã–µ –ø–∞—É–∑—ã (—á–µ–ª–æ–≤–µ–∫ –æ—Ç–≤–ª–µ–∫—Å—è)
        if random.random() < 0.1:  # 10% —à–∞–Ω—Å
            delay *= random.randint(3, 5)
        
        return delay
    
    def perform_warmup_session(self, phase_name: str, settings: dict) -> dict:
        """–í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–µ—Å—Å–∏—é –ø—Ä–æ–≥—Ä–µ–≤–∞"""
        phase = self.WARMUP_PHASES[phase_name]
        session_results = {
            'actions_performed': {},
            'errors': [],
            'session_duration': 0
        }
        
        session_start = time.time()
        
        # –ü–ª–∞–Ω–∏—Ä—É–µ–º –¥–µ–π—Å—Ç–≤–∏—è –Ω–∞ —ç—Ç—É —Å–µ—Å—Å–∏—é
        planned_actions = self.plan_session_actions(phase['actions'])
        
        logger.info(f"üìã –ü–ª–∞–Ω —Å–µ—Å—Å–∏–∏ –ø—Ä–æ–≥—Ä–µ–≤–∞ –¥–ª—è —Ñ–∞–∑—ã {phase['name']}:")
        for action, count in planned_actions.items():
            logger.info(f"   - {action}: {count} —Ä–∞–∑")
        
        # –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–π—Å—Ç–≤–∏—è –≤ —Å–ª—É—á–∞–π–Ω–æ–º –ø–æ—Ä—è–¥–∫–µ
        action_list = []
        for action, count in planned_actions.items():
            action_list.extend([action] * count)
        random.shuffle(action_list)
        
        for i, action in enumerate(action_list):
            try:
                # –ü—Ä–æ–≤–µ—Ä—è–µ–º, —Å—Ç–æ–∏—Ç –ª–∏ –ø—Ä–æ–¥–æ–ª–∂–∞—Ç—å
                if not self.should_perform_action():
                    logger.info("‚è∏Ô∏è –ü–∞—É–∑–∞ –≤ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ (–∏–º–∏—Ç–∞—Ü–∏—è —á–µ–ª–æ–≤–µ—á–µ—Å–∫–æ–≥–æ –ø–æ–≤–µ–¥–µ–Ω–∏—è)")
                    time.sleep(random.randint(300, 900))  # 5-15 –º–∏–Ω—É—Ç –ø–∞—É–∑—ã
                    continue
                
                # –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
                logger.info(f"üéØ –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–π—Å—Ç–≤–∏–µ: {action} ({i+1}/{len(action_list)})")
                
                success = self.perform_action(action, settings)
                
                if success:
                    if action not in session_results['actions_performed']:
                        session_results['actions_performed'][action] = 0
                    session_results['actions_performed'][action] += 1
                
                # –ó–∞–¥–µ—Ä–∂–∫–∞ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏
                delay = self.get_action_delay(action)
                logger.info(f"‚è±Ô∏è –ñ–¥–µ–º {delay} —Å–µ–∫—É–Ω–¥...")
                time.sleep(delay)
                
            except Exception as e:
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ {action}: {e}")
                session_results['errors'].append(f"{action}: {str(e)}")
                
                # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º –∑–∞–¥–µ—Ä–∂–∫—É –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
                time.sleep(random.randint(60, 180))
        
        session_results['session_duration'] = int(time.time() - session_start)
        return session_results
    
    def plan_session_actions(self, actions_config: dict) -> dict:
        """–°–ø–ª–∞–Ω–∏—Ä–æ–≤–∞—Ç—å –¥–µ–π—Å—Ç–≤–∏—è –¥–ª—è —Å–µ—Å—Å–∏–∏"""
        planned = {}
        
        for action, limits in actions_config.items():
            # –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ –¥–µ–π—Å—Ç–≤–∏–π
            count = random.randint(limits['min'], limits['max'])
            
            # –î–æ–±–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å (¬±20%)
            variance = int(count * 0.2)
            if variance > 0:
                count += random.randint(-variance, variance)
            
            # –£–±–µ–∂–¥–∞–µ–º—Å—è, —á—Ç–æ –Ω–µ –≤—ã—Ö–æ–¥–∏–º –∑–∞ –ª–∏–º–∏—Ç—ã
            count = max(limits['min'], min(count, limits['max']))
            
            if count > 0:
                planned[action] = count
        
        return planned
    
    def perform_action(self, action_type: str, settings: dict) -> bool:
        """–í—ã–ø–æ–ª–Ω–∏—Ç—å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ"""
        try:
            # –°–±—Ä–∞—Å—ã–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ —Ç–µ–∫—É—â–µ–π —Å–µ—Å—Å–∏–∏ –ø–µ—Ä–µ–¥ –¥–µ–π—Å—Ç–≤–∏–µ–º
            self.session_stats = {
                'likes': 0,
                'follows': 0,
                'comments': 0,
                'saves': 0,
                'stories': 0,
                'posts': 0
            }
            
            action_map = {
                'view_feed': self.view_feed,
                'view_stories': self.view_stories,
                'view_profiles': self.view_profiles,
                'like_posts': self.like_posts,
                'follow': lambda: self.follow_users(settings),
                'comment': lambda: self.comment_posts(settings),
                'save_posts': self.save_posts,
                'post_story': lambda: self.post_story(settings),
                'post_photo': self.post_photo,
                'watch_reels': self.watch_reels,
                'explore_hashtags': self.explore_hashtags,
                'send_direct': self.send_direct_messages,
                'update_profile': self.update_profile_info
            }
            
            if action_type in action_map:
                result = action_map[action_type]()
                
                # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º –¥–µ–π—Å—Ç–≤–∏–µ –≤ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫—É
                if result:
                    logger.info(f"‚úÖ –î–µ–π—Å—Ç–≤–∏–µ {action_type} –≤—ã–ø–æ–ª–Ω–µ–Ω–æ —É—Å–ø–µ—à–Ω–æ")
                else:
                    logger.warning(f"‚ö†Ô∏è –î–µ–π—Å—Ç–≤–∏–µ {action_type} –Ω–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–æ")
                    
                return result
            else:
                logger.warning(f"–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ: {action_type}")
                return False
                
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ –¥–µ–π—Å—Ç–≤–∏—è {action_type}: {e}")
            return False
    
    def view_feed(self) -> bool:
        """–ü—Ä–æ—Å–º–æ—Ç—Ä –ª–µ–Ω—Ç—ã"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å—Ç—ã –∏–∑ –ª–µ–Ω—Ç—ã
            feed = self.client.client.get_timeline_feed()
            if feed and feed.get('feed_items'):
                # –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä
                view_time = random.randint(2, 8)
                logger.info(f"üëÄ –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ª–µ–Ω—Ç—É {view_time} —Å–µ–∫—É–Ω–¥...")
                time.sleep(view_time)
                return True
            return False
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –ª–µ–Ω—Ç—ã: {e}")
            return False
    
    def view_stories(self) -> bool:
        """–ü—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–π"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º –ª–µ–Ω—Ç—É —Å –∏—Å—Ç–æ—Ä–∏—è–º–∏
            feed = self.client.client.get_timeline_feed()
            
            if feed and feed.get('feed_items'):
                # –§–∏–ª—å—Ç—Ä—É–µ–º —ç–ª–µ–º–µ–Ω—Ç—ã —Å –∏—Å—Ç–æ—Ä–∏—è–º–∏
                story_items = []
                for item in feed['feed_items']:
                    if 'stories_tray' in item:
                        story_items.extend(item['stories_tray'])
                
                if story_items:
                    # –í—ã–±–∏—Ä–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –∏—Å—Ç–æ—Ä–∏–π –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
                    stories_to_view = random.randint(1, min(5, len(story_items)))
                    
                    for i in range(stories_to_view):
                        story = story_items[i]
                        
                        if 'user' in story:
                            logger.info(f"üì± –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –∏—Å—Ç–æ—Ä–∏—é –æ—Ç @{story['user'].get('username', 'unknown')}")
                            
                            # –í—Ä–µ–º—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏
                            view_time = random.randint(2, 5)
                            time.sleep(view_time)
                    
                    return True
                else:
                    logger.info("‚ÑπÔ∏è –ù–µ—Ç –Ω–æ–≤—ã—Ö –∏—Å—Ç–æ—Ä–∏–π –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞")
            
            # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π —Å–ø–æ—Å–æ–± - –ø—Ä–æ—Å—Ç–æ –∏–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä
            logger.info("üì± –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–π...")
            time.sleep(random.randint(10, 20))
            return True
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –∏—Å—Ç–æ—Ä–∏–π: {e}")
            # –í —Å–ª—É—á–∞–µ –æ—à–∏–±–∫–∏ –ø—Ä–æ—Å—Ç–æ –∏–º–∏—Ç–∏—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
            logger.info("üì± –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä –∏—Å—Ç–æ—Ä–∏–π...")
            time.sleep(random.randint(10, 20))
            return True
    
    def view_profiles(self) -> bool:
        """–ü—Ä–æ—Å–º–æ—Ç—Ä –ø—Ä–æ—Ñ–∏–ª–µ–π"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º —Ä–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏–∏ –∏–ª–∏ –∏—Å–ø–æ–ª—å–∑—É–µ–º –ø–æ–∏—Å–∫
            suggested = self.client.client.search_users("fitness", count=10)
            if suggested:
                profile = random.choice(suggested)
                logger.info(f"üë§ –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ø—Ä–æ—Ñ–∏–ª—å @{profile.username}...")
                
                # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø—Ä–æ—Ñ–∏–ª–µ
                user_info = self.client.client.user_info(profile.pk)
                
                # –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä
                view_time = random.randint(5, 15)
                time.sleep(view_time)
                return True
            return False
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ –ø—Ä–æ—Ñ–∏–ª–µ–π: {e}")
            return False
    
    def like_posts(self) -> bool:
        """–õ–∞–π–∫–∞—Ç—å –ø–æ—Å—Ç—ã –∏–∑ –ª–µ–Ω—Ç—ã"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º –ª–µ–Ω—Ç—É
            feed = self.client.client.get_timeline_feed()
            
            if feed and feed.get('feed_items'):
                posts = [item for item in feed['feed_items'] 
                        if item.get('media_or_ad') and 
                        item['media_or_ad'].get('media_type') in [1, 8]]  # 1 - —Ñ–æ—Ç–æ, 8 - –∫–∞—Ä—É—Å–µ–ª—å
                
                if posts:
                    # –õ–∞–π–∫–∞–µ–º 1-3 –ø–æ—Å—Ç–∞
                    posts_to_like = random.randint(1, min(3, len(posts)))
                    
                    for i in range(posts_to_like):
                        post = posts[i]['media_or_ad']
                        media_id = post.get('id')
                        
                        if media_id:
                            self.client.client.media_like(media_id)
                            logger.info("‚ù§Ô∏è –ü–æ—Å—Ç–∞–≤–∏–ª–∏ –ª–∞–π–∫ –Ω–∞ –ø–æ—Å—Ç")
                            
                            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                            self.session_stats['likes'] += 1
                            
                            # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –ª–∞–π–∫–∞–º–∏
                            time.sleep(random.randint(2, 5))
                    
                    # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
                    self.update_task_progress('like_posts')
                    return True
            
            # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥ —á–µ—Ä–µ–∑ —Ö–µ—à—Ç–µ–≥–∏
            hashtags = ['photography', 'nature', 'travel', 'art', 'food']
            hashtag = random.choice(hashtags)
            
            medias = self.client.client.hashtag_medias_recent(hashtag, amount=10)
            
            if medias:
                # –õ–∞–π–∫–∞–µ–º 1-3 –ø–æ—Å—Ç–∞
                posts_to_like = random.randint(1, min(3, len(medias)))
                
                for i in range(posts_to_like):
                    media = medias[i]
                    self.client.client.media_like(media.id)
                    logger.info(f"‚ù§Ô∏è –ü–æ—Å—Ç–∞–≤–∏–ª–∏ –ª–∞–π–∫ –Ω–∞ –ø–æ—Å—Ç –∏–∑ #{hashtag}")
                    
                    # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                    self.session_stats['likes'] += 1
                    
                    # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –ª–∞–π–∫–∞–º–∏
                    time.sleep(random.randint(2, 5))
                
                # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
                self.update_task_progress('like_posts')
                return True
                
            return False
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ª–∞–π–∫–∞—Ö –ø–æ—Å—Ç–æ–≤: {e}")
            return False
    
    def follow_users(self, settings: dict) -> bool:
        """–ü–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤
            target_accounts = settings.get('target_accounts', '')
            unique_follows = settings.get('unique_follows', True)
            
            if not target_accounts:
                logger.warning("‚ö†Ô∏è –ù–µ —É–∫–∞–∑–∞–Ω—ã —Ü–µ–ª–µ–≤—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏")
                return False
            
            # –†–∞–∑–±–∏–≤–∞–µ–º –Ω–∞ —Å–ø–∏—Å–æ–∫
            target_list = [acc.strip().replace('@', '') for acc in target_accounts.split('\n') if acc.strip()]
            
            if not target_list:
                logger.warning("‚ö†Ô∏è –°–ø–∏—Å–æ–∫ —Ü–µ–ª–µ–≤—ã—Ö –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –ø—É—Å—Ç")
                return False
            
            # –ï—Å–ª–∏ –≤–∫–ª—é—á–µ–Ω—ã —É–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏, –≤—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–µ –∞–∫–∫–∞—É–Ω—Ç—ã
            if unique_follows:
                # –í—ã–±–∏—Ä–∞–µ–º 1-5 –∞–∫–∫–∞—É–Ω—Ç–æ–≤ –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏
                follow_count = random.randint(1, min(5, len(target_list)))
                accounts_to_follow = random.sample(target_list, follow_count)
                logger.info(f"üéØ –£–Ω–∏–∫–∞–ª—å–Ω—ã–µ –ø–æ–¥–ø–∏—Å–∫–∏: –≤—ã–±—Ä–∞–Ω–æ {follow_count} –∏–∑ {len(target_list)} –∞–∫–∫–∞—É–Ω—Ç–æ–≤")
            else:
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º –≤–µ—Å—å —Å–ø–∏—Å–æ–∫
                accounts_to_follow = target_list[:5]  # –ú–∞–∫—Å–∏–º—É–º 5 –∑–∞ —Ä–∞–∑
            
            followed_count = 0
            
            for username in accounts_to_follow:
                try:
                    # –ü–æ–ª—É—á–∞–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
                    user = self.client.client.user_info_by_username(username)
                    
                    if user:
                        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –ª–∏ —É–∂–µ
                        if not user.friendship_status.following:
                            # –ü–æ–¥–ø–∏—Å—ã–≤–∞–µ–º—Å—è
                            result = self.client.client.user_follow(user.pk)
                            
                            if result:
                                logger.info(f"‚úÖ –ü–æ–¥–ø–∏—Å–∞–ª–∏—Å—å –Ω–∞ @{username}")
                                followed_count += 1
                                
                                # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                                self.session_stats['follows'] += 1
                                
                                # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –ø–æ–¥–ø–∏—Å–∫–∞–º–∏ (–≤–∞–∂–Ω–æ!)
                                time.sleep(random.randint(10, 30))
                            else:
                                logger.warning(f"‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥–ø–∏—Å–∞—Ç—å—Å—è –Ω–∞ @{username}")
                        else:
                            logger.info(f"‚ÑπÔ∏è –£–∂–µ –ø–æ–¥–ø–∏—Å–∞–Ω—ã –Ω–∞ @{username}")
                    else:
                        logger.warning(f"‚ö†Ô∏è –ù–µ –Ω–∞–π–¥–µ–Ω –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å @{username}")
                        
                except Exception as e:
                    logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–µ –Ω–∞ @{username}: {e}")
                    continue
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
            if followed_count > 0:
                self.update_task_progress('follow')
                
            return followed_count > 0
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø–æ–¥–ø–∏—Å–∫–∞—Ö: {e}")
            return False
    
    def comment_posts(self, settings: dict) -> bool:
        """–ö–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ—Å—Ç–æ–≤"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–∑—ã 3 –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            phase3_settings = settings.get('full_settings', {}).get('phases', {}).get('phase3', {})
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–∫–ª—é—á–µ–Ω–∞ –ª–∏ —Ñ–∞–∑–∞ 3
            if not phase3_settings.get('enabled', False):
                logger.info("üí¨ –§–∞–∑–∞ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –æ—Ç–∫–ª—é—á–µ–Ω–∞")
                return False
            
            # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏
            all_comments = []
            
            # –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            custom_comments = phase3_settings.get('custom_comments', [])
            if custom_comments:
                all_comments.extend(custom_comments)
                logger.info(f"üìù –î–æ–±–∞–≤–ª–µ–Ω–æ {len(custom_comments)} –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏—Ö –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤")
            
            # –î–æ–±–∞–≤–ª—è–µ–º —Å—Ç–∞–Ω–¥–∞—Ä—Ç–Ω—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ —Ç–∏–ø–∞–º
            comment_types = phase3_settings.get('comment_types', {})
            
            # –ó–∞–≥—Ä—É–∂–∞–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –∏–∑ —Ñ–∞–π–ª–∞
            import json
            import os
            
            comments_file = 'data/warmup_comments.json'
            if os.path.exists(comments_file):
                with open(comments_file, 'r', encoding='utf-8') as f:
                    comments_data = json.load(f)
                    
                    # –î–æ–±–∞–≤–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏ –ø–æ –≤—ã–±—Ä–∞–Ω–Ω—ã–º —Ç–∏–ø–∞–º
                    if comment_types.get('positive', False):
                        all_comments.extend(comments_data.get('positive', []))
                    if comment_types.get('compliments', False):
                        all_comments.extend(comments_data.get('compliments', []))
                    if comment_types.get('questions', False):
                        all_comments.extend(comments_data.get('questions', []))
                    if comment_types.get('emojis', False):
                        all_comments.extend(comments_data.get('emojis', []))
                        
                    logger.info(f"üìö –ó–∞–≥—Ä—É–∂–µ–Ω–æ {len(all_comments)} –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤ –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫")
            
            # –ï—Å–ª–∏ –Ω–µ—Ç –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–µ–≤, –∏—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–µ
            if not all_comments:
                all_comments = [
                    "–ö–ª–∞—Å—Å–Ω–æ–µ —Ñ–æ—Ç–æ! üëç",
                    "–û—á–µ–Ω—å –∫—Ä–∞—Å–∏–≤–æ! ‚ú®",
                    "–í–∞—É! üòç",
                    "–°—É–ø–µ—Ä! üî•",
                    "–û—Ç–ª–∏—á–Ω—ã–π –∫–∞–¥—Ä!"
                ]
                logger.info("üìù –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–µ –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–∏")
            
            # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å—Ç—ã –∏–∑ –ª–µ–Ω—Ç—ã
            feed = self.client.client.get_timeline_feed()
            if feed and feed.get('feed_items'):
                items = [item for item in feed['feed_items'] if 'media_or_ad' in item]
                if items:
                    # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –ø–æ—Å—Ç
                    item = random.choice(items[:10])  # –ò–∑ –ø–µ—Ä–≤—ã—Ö 10 –ø–æ—Å—Ç–æ–≤
                    media = item['media_or_ad']
                    
                    if 'id' in media and 'user' in media:
                        # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω—ã–π –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
                        comment_text = random.choice(all_comments)
                        
                        # –î–æ–±–∞–≤–ª—è–µ–º –≤–∞—Ä–∏–∞—Ç–∏–≤–Ω–æ—Å—Ç—å (–∏–Ω–æ–≥–¥–∞ –º–µ–Ω—è–µ–º —Ä–µ–≥–∏—Å—Ç—Ä –∏–ª–∏ –¥–æ–±–∞–≤–ª—è–µ–º —Ç–æ—á–∫–∏)
                        if random.random() < 0.3:
                            comment_text = comment_text.lower()
                        elif random.random() < 0.2:
                            comment_text = comment_text.rstrip('!.') + '...'
                        
                        logger.info(f"üí¨ –ö–æ–º–º–µ–Ω—Ç–∏—Ä—É–µ–º –ø–æ—Å—Ç –æ—Ç @{media['user'].get('username', 'unknown')}: {comment_text}")
                        
                        # –û—Ç–ø—Ä–∞–≤–ª—è–µ–º –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π
                        result = self.client.client.media_comment(media['id'], comment_text)
                        
                        if result:
                            logger.info("‚úÖ –ö–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π —É—Å–ø–µ—à–Ω–æ –¥–æ–±–∞–≤–ª–µ–Ω")
                            return True
                        else:
                            logger.warning("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –¥–æ–±–∞–≤–∏—Ç—å –∫–æ–º–º–µ–Ω—Ç–∞—Ä–∏–π")
            
            return False
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∫–æ–º–º–µ–Ω—Ç–∏—Ä–æ–≤–∞–Ω–∏–∏: {e}")
            return False
    
    def save_posts(self) -> bool:
        """–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –ø–æ—Å—Ç–æ–≤"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º –ª–µ–Ω—Ç—É
            feed = self.client.client.get_timeline_feed()
            
            if feed and feed.get('feed_items'):
                posts = [item for item in feed['feed_items'] 
                        if item.get('media_or_ad') and 
                        item['media_or_ad'].get('media_type') in [1, 8]]  # 1 - —Ñ–æ—Ç–æ, 8 - –∫–∞—Ä—É—Å–µ–ª—å
                
                if posts:
                    # –°–æ—Ö—Ä–∞–Ω—è–µ–º 1-2 –ø–æ—Å—Ç–∞
                    posts_to_save = random.randint(1, min(2, len(posts)))
                    
                    for i in range(posts_to_save):
                        post = posts[i]['media_or_ad']
                        media_id = post.get('id')
                        
                        if media_id:
                            self.client.client.media_save(media_id)
                            logger.info("üíæ –°–æ—Ö—Ä–∞–Ω–∏–ª–∏ –ø–æ—Å—Ç")
                            
                            # –£–≤–µ–ª–∏—á–∏–≤–∞–µ–º —Å—á–µ—Ç—á–∏–∫
                            self.session_stats['saves'] += 1
                            
                            # –ü–∞—É–∑–∞ –º–µ–∂–¥—É —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è–º–∏
                            time.sleep(random.randint(3, 8))
                    
                    # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ–≥—Ä–µ—Å—Å –≤ –±–∞–∑–µ –¥–∞–Ω–Ω—ã—Ö
                    self.update_task_progress('save_posts')
                    return True
                    
            return False
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–∏ –ø–æ—Å—Ç–æ–≤: {e}")
            return False
    
    def post_story(self, settings: dict) -> bool:
        """–ü—É–±–ª–∏–∫–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–∏"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–∑—ã 4 –∏–∑ –∫–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏–∏
            phase4_settings = settings.get('full_settings', {}).get('phases', {}).get('phase4', {})
            
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –≤–∫–ª—é—á–µ–Ω–∞ –ª–∏ —Ñ–∞–∑–∞ 4 –∏ –ø—É–±–ª–∏–∫–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–π
            if not phase4_settings.get('enabled', False):
                logger.info("üì∏ –§–∞–∑–∞ –∏—Å—Ç–æ—Ä–∏–π –æ—Ç–∫–ª—é—á–µ–Ω–∞")
                return False
                
            activities = phase4_settings.get('activities', {})
            if not activities.get('publish', False):
                logger.info("üì∏ –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∏—Å—Ç–æ—Ä–∏–π –æ—Ç–∫–ª—é—á–µ–Ω–∞ –≤ –Ω–∞—Å—Ç—Ä–æ–π–∫–∞—Ö")
                return False
            
            # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç—É—é –∏—Å—Ç–æ—Ä–∏—é —Å —Ç–µ–∫—Å—Ç–æ–º
            from PIL import Image, ImageDraw, ImageFont
            import tempfile
            
            # –°–æ–∑–¥–∞–µ–º –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏
            width, height = 1080, 1920  # –†–∞–∑–º–µ—Ä –¥–ª—è –∏—Å—Ç–æ—Ä–∏–π
            
            # –ü–æ–ª—É—á–∞–µ–º —Å—Ç–∏–ª—å –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            story_style = phase4_settings.get('style', 'gradient')
            
            # –°–æ–∑–¥–∞–µ–º —Ñ–æ–Ω –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Å—Ç–∏–ª—è
            image = Image.new('RGB', (width, height))
            draw = ImageDraw.Draw(image)
            
            if story_style == 'gradient':
                # –°–ª—É—á–∞–π–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç–Ω—ã–π —Ñ–æ–Ω
                colors = [
                    ((255, 94, 77), (255, 154, 0)),    # –û—Ä–∞–Ω–∂–µ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç
                    ((84, 51, 255), (0, 234, 255)),    # –°–∏–Ω–∏–π –≥—Ä–∞–¥–∏–µ–Ω—Ç
                    ((255, 0, 128), (255, 0, 255)),    # –†–æ–∑–æ–≤—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç
                    ((0, 255, 127), (51, 255, 153)),   # –ó–µ–ª–µ–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç
                ]
                
                color1, color2 = random.choice(colors)
                
                for y in range(height):
                    ratio = y / height
                    r = int(color1[0] * (1 - ratio) + color2[0] * ratio)
                    g = int(color1[1] * (1 - ratio) + color2[1] * ratio)
                    b = int(color1[2] * (1 - ratio) + color2[2] * ratio)
                    draw.rectangle([(0, y), (width, y + 1)], fill=(r, g, b))
            else:
                # –û–¥–Ω–æ—Ç–æ–Ω–Ω—ã–π —Ñ–æ–Ω
                colors = [
                    (74, 144, 226),   # –°–∏–Ω–∏–π
                    (156, 39, 176),   # –§–∏–æ–ª–µ—Ç–æ–≤—ã–π
                    (233, 30, 99),    # –†–æ–∑–æ–≤—ã–π
                    (255, 152, 0),    # –û—Ä–∞–Ω–∂–µ–≤—ã–π
                    (76, 175, 80),    # –ó–µ–ª–µ–Ω—ã–π
                ]
                color = random.choice(colors)
                draw.rectangle([(0, 0), (width, height)], fill=color)
            
            # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—Å—Ç—ã –∏–∑ –Ω–∞—Å—Ç—Ä–æ–µ–∫
            story_texts = phase4_settings.get('story_texts', [])
            if not story_texts:
                # –ò—Å–ø–æ–ª—å–∑—É–µ–º –±–∞–∑–æ–≤—ã–µ —Ç–µ–∫—Å—Ç—ã
                story_texts = [
                    "–•–æ—Ä–æ—à–µ–≥–æ –¥–Ω—è! ‚òÄÔ∏è",
                    "–í—Å–µ–º –ø—Ä–∏–≤–µ—Ç! üëã",
                    "–û—Ç–ª–∏—á–Ω–æ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ! üòä",
                    "–ü—Ä–æ–¥—É–∫—Ç–∏–≤–Ω–æ–≥–æ –¥–Ω—è! üí™",
                    "–ü–æ–∑–∏—Ç–∏–≤–Ω—ã–π –Ω–∞—Å—Ç—Ä–æ–π! ‚ú®"
                ]
            
            text = random.choice(story_texts)
            logger.info(f"üìù –í—ã–±—Ä–∞–Ω —Ç–µ–∫—Å—Ç –¥–ª—è –∏—Å—Ç–æ—Ä–∏–∏: {text}")
            
            # –ü—ã—Ç–∞–µ–º—Å—è –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å —Å–∏—Å—Ç–µ–º–Ω—ã–π —à—Ä–∏—Ñ—Ç
            try:
                font = ImageFont.truetype("/System/Library/Fonts/Helvetica.ttc", 80)
            except:
                try:
                    # –î–ª—è Windows
                    font = ImageFont.truetype("arial.ttf", 80)
                except:
                    font = ImageFont.load_default()
            
            # –ü–æ–ª—É—á–∞–µ–º —Ä–∞–∑–º–µ—Ä —Ç–µ–∫—Å—Ç–∞
            bbox = draw.textbbox((0, 0), text, font=font)
            text_width = bbox[2] - bbox[0]
            text_height = bbox[3] - bbox[1]
            
            # –¶–µ–Ω—Ç—Ä–∏—Ä—É–µ–º —Ç–µ–∫—Å—Ç
            x = (width - text_width) // 2
            y = (height - text_height) // 2
            
            # –†–∏—Å—É–µ–º —Ç–µ–∫—Å—Ç —Å —Ç–µ–Ω—å—é
            draw.text((x + 3, y + 3), text, fill=(0, 0, 0, 128), font=font)
            draw.text((x, y), text, fill='white', font=font)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
            with tempfile.NamedTemporaryFile(suffix='.jpg', delete=False) as tmp:
                image.save(tmp.name, 'JPEG', quality=95)
                temp_path = tmp.name
            
            try:
                logger.info(f"üì∏ –ü—É–±–ª–∏–∫—É–µ–º –∏—Å—Ç–æ—Ä–∏—é: {text}")
                
                # –ü—É–±–ª–∏–∫—É–µ–º –∏—Å—Ç–æ—Ä–∏—é
                result = self.client.client.photo_upload_to_story(temp_path)
                
                if result:
                    logger.info("‚úÖ –ò—Å—Ç–æ—Ä–∏—è —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–∞")
                    return True
                else:
                    logger.warning("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é")
                    
            finally:
                # –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
                if os.path.exists(temp_path):
                    os.remove(temp_path)
                    
            return False
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ –∏—Å—Ç–æ—Ä–∏–∏: {e}")
            return False
    
    def post_photo(self) -> bool:
        """–ü—É–±–ª–∏–∫–∞—Ü–∏—è —Ñ–æ—Ç–æ"""
        try:
            # –°–æ–∑–¥–∞–µ–º –ø—Ä–æ—Å—Ç–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            from PIL import Image, ImageDraw
            import tempfile
            
            # –°–æ–∑–¥–∞–µ–º –∫–≤–∞–¥—Ä–∞—Ç–Ω–æ–µ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–µ
            size = 1080
            
            # –°–ª—É—á–∞–π–Ω—ã–π –ø–∞—Ç—Ç–µ—Ä–Ω
            patterns = ['gradient', 'circles', 'lines']
            pattern = random.choice(patterns)
            
            image = Image.new('RGB', (size, size), 'white')
            draw = ImageDraw.Draw(image)
            
            if pattern == 'gradient':
                # –†–∞–¥–∏–∞–ª—å–Ω—ã–π –≥—Ä–∞–¥–∏–µ–Ω—Ç
                center_x, center_y = size // 2, size // 2
                max_radius = size // 2
                
                for i in range(size):
                    for j in range(size):
                        distance = ((i - center_x) ** 2 + (j - center_y) ** 2) ** 0.5
                        ratio = min(distance / max_radius, 1)
                        
                        color = (
                            int(255 * (1 - ratio)),
                            int(200 * (1 - ratio) + 55),
                            int(150 * ratio + 105)
                        )
                        draw.point((i, j), fill=color)
                        
            elif pattern == 'circles':
                # –°–ª—É—á–∞–π–Ω—ã–µ –∫—Ä—É–≥–∏
                for _ in range(random.randint(5, 15)):
                    x = random.randint(0, size)
                    y = random.randint(0, size)
                    radius = random.randint(50, 200)
                    color = (
                        random.randint(100, 255),
                        random.randint(100, 255),
                        random.randint(100, 255)
                    )
                    draw.ellipse(
                        [(x - radius, y - radius), (x + radius, y + radius)],
                        fill=color,
                        outline=color
                    )
            
            # –ü–æ–¥–ø–∏—Å–∏ –¥–ª—è –ø–æ—Å—Ç–æ–≤
            captions = [
                "–ù–æ–≤—ã–π –¥–µ–Ω—å - –Ω–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ üåü",
                "–ú–æ–º–µ–Ω—Ç –¥–ª—è —Å–µ–±—è üí´",
                "–í–¥–æ—Ö–Ω–æ–≤–µ–Ω–∏–µ –ø–æ–≤—Å—é–¥—É ‚ú®",
                "–°–æ–∑–¥–∞–µ–º –∫—Ä–∞—Å–æ—Ç—É üé®",
                "–ü—Ä–æ—Å—Ç–æ —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ üòä"
            ]
            
            caption = random.choice(captions)
            
            # –°–æ—Ö—Ä–∞–Ω—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
            with tempfile.NamedTemporaryFile(suffix='.jpg', delete=False) as tmp:
                image.save(tmp.name, 'JPEG', quality=95)
                temp_path = tmp.name
            
            try:
                logger.info(f"üñºÔ∏è –ü—É–±–ª–∏–∫—É–µ–º —Ñ–æ—Ç–æ —Å –ø–æ–¥–ø–∏—Å—å—é: {caption}")
                
                # –ü—É–±–ª–∏–∫—É–µ–º —Ñ–æ—Ç–æ
                result = self.client.client.photo_upload(temp_path, caption)
                
                if result:
                    logger.info("‚úÖ –§–æ—Ç–æ —É—Å–ø–µ—à–Ω–æ –æ–ø—É–±–ª–∏–∫–æ–≤–∞–Ω–æ")
                    return True
                else:
                    logger.warning("‚ö†Ô∏è –ù–µ —É–¥–∞–ª–æ—Å—å –æ–ø—É–±–ª–∏–∫–æ–≤–∞—Ç—å —Ñ–æ—Ç–æ")
                    
            finally:
                # –£–¥–∞–ª—è–µ–º –≤—Ä–µ–º–µ–Ω–Ω—ã–π —Ñ–∞–π–ª
                if os.path.exists(temp_path):
                    os.remove(temp_path)
                    
            return False
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—É–±–ª–∏–∫–∞—Ü–∏–∏ —Ñ–æ—Ç–æ: {e}")
            return False
    
    def watch_reels(self) -> bool:
        """–ü—Ä–æ—Å–º–æ—Ç—Ä Reels"""
        try:
            # –ò—Å–ø–æ–ª—å–∑—É–µ–º explore –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è Reels
            try:
                # –ü—Ä–æ–±—É–µ–º –ø–æ–ª—É—á–∏—Ç—å Reels —á–µ—Ä–µ–∑ explore
                explore = self.client.client.explore()
                
                if explore and 'items' in explore:
                    # –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –≤–∏–¥–µ–æ (Reels)
                    reels_items = [item for item in explore['items'] 
                                  if item.get('media', {}).get('media_type') == 2]  # 2 = video
                    
                    if reels_items:
                        # –í—ã–±–∏—Ä–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ reels –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
                        reels_to_watch = random.randint(2, min(5, len(reels_items)))
                        
                        for i in range(reels_to_watch):
                            # –í—Ä–µ–º—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ reels (15-60 —Å–µ–∫—É–Ω–¥)
                            watch_time = random.randint(15, 60)
                            logger.info(f"üé¨ –°–º–æ—Ç—Ä–∏–º Reels {i+1}/{reels_to_watch} ({watch_time} —Å–µ–∫)...")
                            time.sleep(watch_time)
                            
                            # –ò–Ω–æ–≥–¥–∞ –ª–∞–π–∫–∞–µ–º reels
                            if random.random() < 0.4:  # 40% —à–∞–Ω—Å
                                reel = reels_items[i]
                                if 'media' in reel:
                                    try:
                                        media_id = reel['media']['id']
                                        self.client.client.media_like(media_id)
                                        logger.info("‚ù§Ô∏è –ü–æ—Å—Ç–∞–≤–∏–ª–∏ –ª–∞–π–∫ –Ω–∞ Reels")
                                    except:
                                        pass
                        
                        return True
            except Exception as e:
                logger.debug(f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å Reels —á–µ—Ä–µ–∑ explore: {e}")
            
            # –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–Ω—ã–π –º–µ—Ç–æ–¥: –ø–æ–ª—É—á–∞–µ–º –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ —Ö–µ—à—Ç–µ–≥–∏
            try:
                hashtags = ['reels', 'viral', 'trending', 'fyp', 'foryou']
                hashtag = random.choice(hashtags)
                
                # –ü–æ–ª—É—á–∞–µ–º –º–µ–¥–∏–∞ –ø–æ —Ö–µ—à—Ç–µ–≥—É
                medias = self.client.client.hashtag_medias_recent(hashtag, amount=10)
                
                # –§–∏–ª—å—Ç—Ä—É–µ–º —Ç–æ–ª—å–∫–æ –≤–∏–¥–µ–æ
                videos = [m for m in medias if hasattr(m, 'media_type') and m.media_type == 2]
                
                if videos:
                    # –í—ã–±–∏—Ä–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –≤–∏–¥–µ–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞
                    videos_to_watch = random.randint(2, min(5, len(videos)))
                    
                    for i in range(videos_to_watch):
                        # –í—Ä–µ–º—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ (15-60 —Å–µ–∫—É–Ω–¥)
                        watch_time = random.randint(15, 60)
                        logger.info(f"üé¨ –°–º–æ—Ç—Ä–∏–º –≤–∏–¥–µ–æ {i+1}/{videos_to_watch} –∏–∑ #{hashtag} ({watch_time} —Å–µ–∫)...")
                        time.sleep(watch_time)
                        
                        # –ò–Ω–æ–≥–¥–∞ –ª–∞–π–∫–∞–µ–º
                        if random.random() < 0.4:  # 40% —à–∞–Ω—Å
                            try:
                                video = videos[i]
                                self.client.client.media_like(video.id)
                                logger.info("‚ù§Ô∏è –ü–æ—Å—Ç–∞–≤–∏–ª–∏ –ª–∞–π–∫ –Ω–∞ –≤–∏–¥–µ–æ")
                            except:
                                pass
                    
                    return True
                else:
                    logger.info("‚ÑπÔ∏è –ù–µ –Ω–∞–π–¥–µ–Ω–æ –≤–∏–¥–µ–æ –¥–ª—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞")
            except Exception as e:
                logger.debug(f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å –≤–∏–¥–µ–æ —á–µ—Ä–µ–∑ —Ö–µ—à—Ç–µ–≥–∏: {e}")
            
            # –ï—Å–ª–∏ –Ω–∏—á–µ–≥–æ –Ω–µ –ø–æ–ª—É—á–∏–ª–æ—Å—å, –ø—Ä–æ—Å—Ç–æ –∏–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä
            logger.info("üé¨ –ò–º–∏—Ç–∏—Ä—É–µ–º –ø—Ä–æ—Å–º–æ—Ç—Ä Reels")
            time.sleep(random.randint(30, 90))
            return True
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –ø—Ä–æ—Å–º–æ—Ç—Ä–µ Reels: {e}")
            return False
    
    def explore_hashtags(self) -> bool:
        """–ò—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ —Ö–µ—à—Ç–µ–≥–æ–≤"""
        try:
            # –ü–æ–ø—É–ª—è—Ä–Ω—ã–µ —Ö–µ—à—Ç–µ–≥–∏ –¥–ª—è –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏—è
            hashtags = [
                'photography', 'nature', 'travel', 'fitness', 'food',
                'art', 'fashion', 'music', 'motivation', 'lifestyle'
            ]
            
            hashtag = random.choice(hashtags)
            logger.info(f"üîç –ò—Å—Å–ª–µ–¥—É–µ–º —Ö–µ—à—Ç–µ–≥ #{hashtag}")
            
            # –ü–æ–∏—Å–∫ –ø–æ —Ö–µ—à—Ç–µ–≥—É
            results = self.client.client.hashtag_medias_recent(hashtag, amount=20)
            
            if results:
                # –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –Ω–µ—Å–∫–æ–ª—å–∫–æ –ø–æ—Å—Ç–æ–≤
                posts_to_view = random.randint(3, min(10, len(results)))
                
                for i in range(posts_to_view):
                    # –í—Ä–µ–º—è –ø—Ä–æ—Å–º–æ—Ç—Ä–∞ –ø–æ—Å—Ç–∞
                    view_time = random.randint(3, 12)
                    logger.info(f"üëÄ –ü—Ä–æ—Å–º–∞—Ç—Ä–∏–≤–∞–µ–º –ø–æ—Å—Ç {i+1}/{posts_to_view}")
                    time.sleep(view_time)
                    
                    # –ò–Ω–æ–≥–¥–∞ –ª–∞–π–∫–∞–µ–º
                    if random.random() < 0.3:  # 30% —à–∞–Ω—Å
                        try:
                            post = results[i]
                            self.client.client.media_like(post.id)
                            logger.info("‚ù§Ô∏è –ü–æ—Å—Ç–∞–≤–∏–ª–∏ –ª–∞–π–∫")
                        except:
                            pass
                
                return True
            
            return False
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–∏ —Ö–µ—à—Ç–µ–≥–æ–≤: {e}")
            return False
    
    def send_direct_messages(self) -> bool:
        """–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –¥–∏—Ä–µ–∫—Ç"""
        try:
            # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é
            if not self.client.check_login():
                logger.warning("‚ö†Ô∏è –ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –ø—Ä–æ–ø—É—Å–∫–∞–µ–º —Å–æ–æ–±—â–µ–Ω–∏—è")
                return False
            
            # –ü—Ä–æ—Å—Ç–∞—è –∏–º–∏—Ç–∞—Ü–∏—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –≤ –¥–∏—Ä–µ–∫—Ç–µ
            # –í–º–µ—Å—Ç–æ —Ä–µ–∞–ª—å–Ω–æ–π –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π, –ø—Ä–æ—Å—Ç–æ –∏–º–∏—Ç–∏—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å
            logger.info("üí¨ –ò–º–∏—Ç–∏—Ä—É–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –¥–∏—Ä–µ–∫—Ç–µ")
            
            # –ú–æ–∂–Ω–æ –¥–æ–±–∞–≤–∏—Ç—å –ø—Ä–æ—Å–º–æ—Ç—Ä —Å—É—â–µ—Å—Ç–≤—É—é—â–∏—Ö —á–∞—Ç–æ–≤
            try:
                # –ü–æ–ª—É—á–∞–µ–º —Å–ø–∏—Å–æ–∫ —á–∞—Ç–æ–≤ (–±–µ–∑ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π)
                inbox = self.client.client.direct_threads()
                if inbox:
                    logger.info(f"üì• –ü—Ä–æ—Å–º–æ—Ç—Ä–µ–ª–∏ {len(inbox)} —á–∞—Ç–æ–≤ –≤ –¥–∏—Ä–µ–∫—Ç–µ")
                    return True
            except Exception as e:
                logger.debug(f"–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —á–∞—Ç—ã: {e}")
            
            # –ï—Å–ª–∏ –Ω–µ—Ç —á–∞—Ç–æ–≤, –ø—Ä–æ—Å—Ç–æ –≤–æ–∑–≤—Ä–∞—â–∞–µ–º —É—Å–ø–µ—Ö (–∏–º–∏—Ç–∞—Ü–∏—è)
            logger.info("üí¨ –ê–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –≤ –¥–∏—Ä–µ–∫—Ç–µ –≤—ã–ø–æ–ª–Ω–µ–Ω–∞")
            return True
            
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ —Ä–∞–±–æ—Ç–µ —Å —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏: {e}")
            return False
    
    def update_profile_info(self) -> bool:
        """–û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è"""
        try:
            # –ü–æ–ª—É—á–∞–µ–º —Ç–µ–∫—É—â—É—é –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é
            current_info = self.client.client.account_info()
            
            # –í–∞—Ä–∏–∞–Ω—Ç—ã –±–∏–æ
            bio_templates = [
                "üì∏ Photography enthusiast\nüåç Travel lover\n‚ú® Living my best life",
                "üé® Creative soul\nüìö Book lover\n‚òï Coffee addict",
                "üèÉ‚Äç‚ôÇÔ∏è Fitness journey\nü•ó Healthy lifestyle\nüí™ Never give up",
                "üéµ Music is life\nüé∏ Guitar player\nüé§ Singer",
                "üë®‚Äçüíª Tech enthusiast\nüöÄ Innovation lover\nüí° Always learning"
            ]
            
            # –í—ã–±–∏—Ä–∞–µ–º —Å–ª—É—á–∞–π–Ω–æ–µ –±–∏–æ
            new_bio = random.choice(bio_templates)
            
            logger.info(f"üìù –û–±–Ω–æ–≤–ª—è–µ–º –±–∏–æ –ø—Ä–æ—Ñ–∏–ª—è")
            
            # –û–±–Ω–æ–≤–ª—è–µ–º –ø—Ä–æ—Ñ–∏–ª—å
            result = self.client.client.account_edit(
                biography=new_bio,
                external_url=current_info.get('external_url', ''),
                email=current_info.get('email', ''),
                phone_number=current_info.get('phone_number', ''),
                username=current_info.get('username', ''),
                full_name=current_info.get('full_name', '')
            )
            
            if result:
                logger.info("‚úÖ –ü—Ä–æ—Ñ–∏–ª—å —É—Å–ø–µ—à–Ω–æ –æ–±–Ω–æ–≤–ª–µ–Ω")
                return True
            
            return False
        except Exception as e:
            logger.error(f"–û—à–∏–±–∫–∞ –ø—Ä–∏ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–∏ –ø—Ä–æ—Ñ–∏–ª—è: {e}")
            return False
    
    def perform_human_warmup_session(self, settings: dict) -> dict:
        """–í—ã–ø–æ–ª–Ω–∏—Ç—å —Å–µ—Å—Å–∏—é –ø—Ä–æ–≥—Ä–µ–≤–∞ —Å —á–µ–ª–æ–≤–µ—á–µ—Å–∫–∏–º –ø–æ–≤–µ–¥–µ–Ω–∏–µ–º"""
        session_results = {
            'actions_performed': {},
            'errors': [],
            'session_duration': 0,
            'session_type': 'human_behavior',
            'interest_based': False
        }
        
        session_start = time.time()
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ª–∏ –ø—Ä–æ–≥—Ä–µ–≤ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º
        if 'interests' in settings and self.interest_warmup is None:
            self.setup_interest_warmup(settings['interests'])
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –º–æ–∂–Ω–æ –ª–∏ –Ω–∞—á–∞—Ç—å —Å–µ—Å—Å–∏—é
        if not self.behavior_manager.should_start_session():
            logger.info("‚è∏Ô∏è –ï—â–µ –Ω–µ –≤—Ä–µ–º—è –¥–ª—è –Ω–æ–≤–æ–π —Å–µ—Å—Å–∏–∏ –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏")
            return session_results
        
        # –ï—Å–ª–∏ –Ω–∞—Å—Ç—Ä–æ–µ–Ω –ø—Ä–æ–≥—Ä–µ–≤ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º, –∏—Å–ø–æ–ª—å–∑—É–µ–º –µ–≥–æ —Å –≤–µ—Ä–æ—è—Ç–Ω–æ—Å—Ç—å—é 60%
        if self.interest_warmup and random.random() < 0.6:
            logger.info("üéØ –ò—Å–ø–æ–ª—å–∑—É–µ–º –ø—Ä–æ–≥—Ä–µ–≤ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º")
            session_results['session_type'] = 'interest_based'
            session_results['interest_based'] = True
            
            try:
                # –í—ã–ø–æ–ª–Ω—è–µ–º —Å–µ—Å—Å–∏—é –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º
                interest_results = self.interest_warmup.perform_interest_warmup_session(
                    duration_minutes=random.randint(15, 35)
                )
                
                # –û–±—ä–µ–¥–∏–Ω—è–µ–º —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã
                session_results.update(interest_results)
                session_results['session_duration'] = interest_results['session_duration']
                
                logger.info("‚úÖ –°–µ—Å—Å–∏—è –ø—Ä–æ–≥—Ä–µ–≤–∞ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º –∑–∞–≤–µ—Ä—à–µ–Ω–∞")
                return session_results
                
            except Exception as e:
                logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–æ–≥—Ä–µ–≤–∞ –ø–æ –∏–Ω—Ç–µ—Ä–µ—Å–∞–º: {e}")
                session_results['errors'].append(f"Interest warmup error: {str(e)}")
                # –ü–µ—Ä–µ—Ö–æ–¥–∏–º –∫ –æ–±—ã—á–Ω–æ–º—É –ø—Ä–æ–≥—Ä–µ–≤—É
                session_results['session_type'] = 'human_behavior'
                session_results['interest_based'] = False
        
        # –ü—Ä–æ–≤–µ—Ä—è–µ–º –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏—é –ø–µ—Ä–µ–¥ –Ω–∞—á–∞–ª–æ–º —Å–µ—Å—Å–∏–∏
        if not self.client.check_login():
            logger.warning("‚ùå –ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π, –æ—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º —Å–µ—Å—Å–∏—é")
            session_results['errors'].append("–ü—Ä–æ–±–ª–µ–º–∞ —Å –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–µ–π")
            return session_results
        
        # –ù–∞—á–∏–Ω–∞–µ–º —Å–µ—Å—Å–∏—é
        self.behavior_manager.start_session()
        
        try:
            actions_performed = 0
            max_actions_per_session = 10  # –ú–∞–∫—Å–∏–º—É–º –¥–µ–π—Å—Ç–≤–∏–π –∑–∞ —Å–µ—Å—Å–∏—é
            
            while not self.behavior_manager.should_end_session() and actions_performed < max_actions_per_session:
                # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π
                action_sequence = self.behavior_manager.get_next_action_sequence()
                
                if not action_sequence:
                    logger.info("üåô –ù–æ—á–Ω–æ–µ –≤—Ä–µ–º—è - –ø—Ä–µ–∫—Ä–∞—â–∞–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å")
                    break
                
                logger.info(f"üìã –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å: {' ‚Üí '.join(action_sequence)}")
                
                # –í—ã–ø–æ–ª–Ω—è–µ–º –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—å –¥–µ–π—Å—Ç–≤–∏–π
                for action in action_sequence:
                    if action in ['rest', 'long_rest']:
                        # –û—Ç–¥—ã—Ö
                        delay = self.behavior_manager.get_action_delay(action, is_rest=True)
                        # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –≤—Ä–µ–º—è –æ—Ç–¥—ã—Ö–∞ –º–∞–∫—Å–∏–º—É–º 5 –º–∏–Ω—É—Ç–∞–º–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                        delay = min(delay, 300)
                        logger.info(f"üò¥ –û—Ç–¥—ã—Ö–∞–µ–º {delay//60} –º–∏–Ω—É—Ç {delay%60} —Å–µ–∫—É–Ω–¥ ({action})")
                        time.sleep(delay)
                        continue
                    
                    # –ü—Ä–æ–≤–µ—Ä—è–µ–º, –Ω–µ –ø–æ—Ä–∞ –ª–∏ –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ—Å—Å–∏—é
                    if self.behavior_manager.should_end_session() or actions_performed >= max_actions_per_session:
                        logger.info("‚è∞ –í—Ä–µ–º—è –∑–∞–≤–µ—Ä—à–∏—Ç—å —Å–µ—Å—Å–∏—é")
                        break
                    
                    try:
                        # –í—ã–ø–æ–ª–Ω—è–µ–º –¥–µ–π—Å—Ç–≤–∏–µ
                        logger.info(f"üéØ –í—ã–ø–æ–ª–Ω—è–µ–º: {action}")
                        success = self.perform_action(action, settings)
                        
                        actions_performed += 1
                        
                        if success:
                            # –ó–∞–ø–∏—Å—ã–≤–∞–µ–º —É—Å–ø–µ—à–Ω–æ–µ –¥–µ–π—Å—Ç–≤–∏–µ
                            if action not in session_results['actions_performed']:
                                session_results['actions_performed'][action] = 0
                            session_results['actions_performed'][action] += 1
                            
                            # –£–≤–µ–¥–æ–º–ª—è–µ–º behavior manager
                            self.behavior_manager.record_action(action)
                        
                        # –ü–∞—É–∑–∞ –º–µ–∂–¥—É –¥–µ–π—Å—Ç–≤–∏—è–º–∏
                        delay = self.behavior_manager.get_action_delay(action)
                        # –û–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ–º –∑–∞–¥–µ—Ä–∂–∫–∏ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è
                        delay = min(delay, 60)
                        logger.info(f"‚è±Ô∏è –ü–∞—É–∑–∞ {delay} —Å–µ–∫—É–Ω–¥...")
                        time.sleep(delay)
                        
                    except Exception as e:
                        logger.error(f"‚ùå –û—à–∏–±–∫–∞ –ø—Ä–∏ –≤—ã–ø–æ–ª–Ω–µ–Ω–∏–∏ {action}: {e}")
                        session_results['errors'].append(f"{action}: {str(e)}")
                        
                        # –£–≤–µ–ª–∏—á–µ–Ω–Ω–∞—è –ø–∞—É–∑–∞ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
                        error_delay = random.randint(30, 60)  # –£–º–µ–Ω—å—à–∏–ª–∏ –ø–∞—É–∑—É –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏
                        logger.info(f"‚ö†Ô∏è –ü–∞—É–∑–∞ –ø–æ—Å–ª–µ –æ—à–∏–±–∫–∏: {error_delay} —Å–µ–∫—É–Ω–¥")
                        time.sleep(error_delay)
                
                # –ù–µ–±–æ–ª—å—à–∞—è –ø–∞—É–∑–∞ –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏
                if not self.behavior_manager.should_end_session() and actions_performed < max_actions_per_session:
                    sequence_break = random.randint(10, 30)  # –£–º–µ–Ω—å—à–∏–ª–∏ –ø–∞—É–∑—É –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏
                    logger.info(f"üîÑ –ü–∞—É–∑–∞ –º–µ–∂–¥—É –ø–æ—Å–ª–µ–¥–æ–≤–∞—Ç–µ–ª—å–Ω–æ—Å—Ç—è–º–∏: {sequence_break} —Å–µ–∫—É–Ω–¥")
                    time.sleep(sequence_break)
        
        finally:
            # –ó–∞–≤–µ—Ä—à–∞–µ–º —Å–µ—Å—Å–∏—é
            self.behavior_manager.end_session()
            session_results['session_duration'] = int(time.time() - session_start)
        
        return session_results 
            

