# üîê –°–∏—Å—Ç–µ–º–∞ –ö–æ–Ω—Ç—Ä–æ–ª—è –î–æ—Å—Ç—É–ø–∞ Instagram Telegram Bot

## üìã –û–±–∑–æ—Ä

–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–∞ –ø–æ–ª–Ω–æ—Ü–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –∫–æ–Ω—Ç—Ä–æ–ª—è –¥–æ—Å—Ç—É–ø–∞ —Å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏–º —Å–æ–∑–¥–∞–Ω–∏–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –∏ –±–ª–æ–∫–∏—Ä–æ–≤–∫–æ–π —Ñ—É–Ω–∫—Ü–∏–π –¥–æ –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏ –æ—Ç –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–∞.

## üéØ –ü—Ä–∏–Ω—Ü–∏–ø —Ä–∞–±–æ—Ç—ã

### 1. üë§ –†–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –Ω–∞–∂–∏–º–∞–µ—Ç `/start` –≤ –æ—Å–Ω–æ–≤–Ω–æ–º –±–æ—Ç–µ
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ —Å–æ–∑–¥–∞–µ—Ç –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –≤ –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏
- –î–æ—Å—Ç—É–ø –∫ —Ñ—É–Ω–∫—Ü–∏—è–º **–∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω** –¥–æ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º

### 2. üí≥ –ü–æ–∫—É–ø–∫–∞ –∏ –∞–∫—Ç–∏–≤–∞—Ü–∏—è
- –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω
- –°–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–º: `@admin`
- –°–æ–æ–±—â–∞–µ—Ç —Å–≤–æ–π `Username` –∏ `Telegram ID`
- –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–±–æ—Ç

### 3. ‚úÖ –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –±–æ—Ç–∞
- –ü–æ—Å–ª–µ –∞–∫—Ç–∏–≤–∞—Ü–∏–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –ø–æ–ª—É—á–∞–µ—Ç –ø–æ–ª–Ω—ã–π –¥–æ—Å—Ç—É–ø
- –°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Å—Ä–æ–∫–∏ –ø–æ–¥–ø–∏—Å–∫–∏
- –ü—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏ –¥–æ—Å—Ç—É–ø –±–ª–æ–∫–∏—Ä—É–µ—Ç—Å—è

## üí∞ –¢–∞—Ä–∏—Ñ–Ω—ã–µ –ø–ª–∞–Ω—ã

| –ü–ª–∞–Ω | –°—Ä–æ–∫ | –¶–µ–Ω–∞ | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|------|------|----------|
| üÜì –¢—Ä–∏–∞–ª 1 –¥–µ–Ω—å | 1 –¥–µ–Ω—å | $0 | –ë–µ—Å–ø–ª–∞—Ç–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| üÜì –¢—Ä–∏–∞–ª 3 –¥–Ω—è | 3 –¥–Ω—è | $0 | –†–∞—Å—à–∏—Ä–µ–Ω–Ω–æ–µ —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ |
| üÜì –¢—Ä–∏–∞–ª 7 –¥–Ω–µ–π | 7 –¥–Ω–µ–π | $0 | –ü–æ–ª–Ω–æ–µ –æ–∑–Ω–∞–∫–æ–º–ª–µ–Ω–∏–µ |
| üí≥ –ú–µ—Å—è—Ü | 30 –¥–Ω–µ–π | $200 | –û—Å–Ω–æ–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞ |
| üí≥ 3 –º–µ—Å—è—Ü–∞ | 90 –¥–Ω–µ–π | $400 | –≠–∫–æ–Ω–æ–º–∏—á–Ω—ã–π –ø–ª–∞–Ω |
| üíé –ù–∞–≤—Å–µ–≥–¥–∞ | ‚àû | $500 | –ë–µ–∑–ª–∏–º–∏—Ç–Ω—ã–π –¥–æ—Å—Ç—É–ø |

## üîß –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∏–µ –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

### üìÅ –§–∞–π–ª—ã —Å–∏—Å—Ç–µ–º—ã

#### 1. `telegram_bot/middleware.py`
- `@subscription_required` - –±–ª–æ–∫–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏
- `@trial_allowed` - —Ä–∞–∑—Ä–µ—à–∞–µ—Ç –¥–æ—Å—Ç—É–ø –Ω–∞ —Ç—Ä–∏–∞–ª–µ
- `@premium_only` - —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–ª–∞—Ç–Ω—ã—Ö –ø–æ–¥–ø–∏—Å–æ–∫
- `@admin_only` - —Ç–æ–ª—å–∫–æ –¥–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤

#### 2. `utils/subscription_service.py`
- `check_user_access()` - –ø—Ä–æ–≤–µ—Ä–∫–∞ –ø—Ä–∞–≤ –¥–æ—Å—Ç—É–ø–∞
- `ensure_user_exists()` - –∞–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å—é

#### 3. `telegram_bot/handlers/account_handlers.py`
- –û–±–Ω–æ–≤–ª–µ–Ω–Ω–∞—è –∫–æ–º–∞–Ω–¥–∞ `/start`
- –û—Ç–æ–±—Ä–∞–∂–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ –¥–æ—Å—Ç—É–ø–∞
- –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏ –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –ø–æ–¥–ø–∏—Å–∫–∏

### üõ°Ô∏è –ü—Ä–∏–º–µ–Ω–µ–Ω–∏–µ –∑–∞—â–∏—Ç—ã

```python
# –û—Å–Ω–æ–≤–Ω—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏ –∑–∞—â–∏—â–µ–Ω—ã –¥–µ–∫–æ—Ä–∞—Ç–æ—Ä–∞–º–∏:
@subscription_required  # –ì–ª–∞–≤–Ω—ã–π –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ callback
@trial_allowed         # –§—É–Ω–∫—Ü–∏–∏ –¥–æ—Å—Ç—É–ø–Ω—ã–µ –Ω–∞ —Ç—Ä–∏–∞–ª–µ
@premium_only          # –§—É–Ω–∫—Ü–∏–∏ —Ç–æ–ª—å–∫–æ –¥–ª—è –ø–ª–∞—Ç–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤
```

## üì± –ü–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å—Å–∫–∏–π –æ–ø—ã—Ç

### –ù–æ–≤—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç:
```
üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Instagram Bot!

üë§ –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:
‚Ä¢ Username: @username
‚Ä¢ Telegram ID: 123456789

üîê –°—Ç–∞—Ç—É—Å –¥–æ—Å—Ç—É–ø–∞: ‚ùå –ó–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–Ω

üìã –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –¥–æ—Å—Ç—É–ø–∞:

1Ô∏è‚É£ –í—ã–±–µ—Ä–∏—Ç–µ —Ç–∞—Ä–∏—Ñ–Ω—ã–π –ø–ª–∞–Ω:
   ‚Ä¢ üÜì –¢—Ä–∏–∞–ª 1 –¥–µ–Ω—å - –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
   ‚Ä¢ üÜì –¢—Ä–∏–∞–ª 3 –¥–Ω—è - –ë–µ—Å–ø–ª–∞—Ç–Ω–æ  
   ‚Ä¢ üÜì –¢—Ä–∏–∞–ª 7 –¥–Ω–µ–π - –ë–µ—Å–ø–ª–∞—Ç–Ω–æ
   ‚Ä¢ üí≥ 1 –º–µ—Å—è—Ü - $200
   ‚Ä¢ üí≥ 3 –º–µ—Å—è—Ü–∞ - $400
   ‚Ä¢ üíé –ù–∞–≤—Å–µ–≥–¥–∞ - $500

2Ô∏è‚É£ –ù–∞–ø–∏—à–∏—Ç–µ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É:
   üìû –¢–µ–ª–µ–≥—Ä–∞–º: @admin
   üì® –°–æ–æ–±—â–∏—Ç–µ: Username @username –∏ ID 123456789

3Ô∏è‚É£ –ü–æ—Å–ª–µ –æ–ø–ª–∞—Ç—ã –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç –¥–æ—Å—Ç—É–ø

‚ùó –î–ª—è –¥–æ—Å—Ç—É–ø–∞ –∫ —Ñ—É–Ω–∫—Ü–∏—è–º –Ω–µ–æ–±—Ö–æ–¥–∏–º–∞ –∞–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–ø–∏—Å–∫–∞
```

### –ê–∫—Ç–∏–≤–Ω—ã–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—å –≤–∏–¥–∏—Ç:
```
üëã –î–æ–±—Ä–æ –ø–æ–∂–∞–ª–æ–≤–∞—Ç—å –≤ Instagram Bot!

üë§ –í–∞—à–∏ –¥–∞–Ω–Ω—ã–µ:
‚Ä¢ Username: @username
‚Ä¢ Telegram ID: 123456789

üíé –í–∞—à —Å—Ç–∞—Ç—É—Å: üí≥ –ü–æ–¥–ø–∏—Å–∫–∞ 30 –¥–Ω–µ–π
‚è∞ –û—Å—Ç–∞–ª–æ—Å—å –¥–Ω–µ–π: 25

‚úÖ –í—ã –º–æ–∂–µ—Ç–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞:
‚Ä¢ –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–æ–≤
‚Ä¢ –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
‚Ä¢ –ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è
‚Ä¢ –ê–Ω–∞–ª–∏—Ç–∏–∫–∞

üìã –î–æ—Å—Ç—É–ø–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã:
/accounts - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–∫–∫–∞—É–Ω—Ç–∞–º–∏
/publish - –ü—É–±–ª–∏–∫–∞—Ü–∏—è –∫–æ–Ω—Ç–µ–Ω—Ç–∞
/analytics - –ê–Ω–∞–ª–∏—Ç–∏–∫–∞
/help - –ü–æ–º–æ—â—å
```

## üéõÔ∏è –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å

### ‚ûï –î–æ–±–∞–≤–ª–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
1. –ù–∞–∂–∞—Ç—å "‚ûï –î–æ–±–∞–≤–∏—Ç—å –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è"
2. –í–≤–µ—Å—Ç–∏: `telegram_id username plan`
3. –ü—Ä–∏–º–µ—Ä: `123456789 testuser month`

### üîç –ü–æ–∏—Å–∫ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- –ü–æ Telegram ID: `123456789`
- –ü–æ username: `@username` –∏–ª–∏ `username`

### ‚úèÔ∏è –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –ø–æ–¥–ø–∏—Å–∫–∞–º–∏
- **–ò–∑–º–µ–Ω–µ–Ω–∏–µ –ø–ª–∞–Ω–∞** - —Å–º–µ–Ω–∞ —Ç–∞—Ä–∏—Ñ–∞
- **–ü—Ä–æ–¥–ª–µ–Ω–∏–µ** - –¥–æ–±–∞–≤–ª–µ–Ω–∏–µ –¥–Ω–µ–π
- **–ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞/—Ä–∞–∑–±–ª–æ–∫–∏—Ä–æ–≤–∫–∞** - —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–æ–º

## üß™ –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ

–ó–∞–ø—É—Å—Ç–∏—Ç–µ —Ç–µ—Å—Ç —Å–∏—Å—Ç–µ–º—ã:
```bash
source fresh_env/bin/activate
python test_access_control.py
```

–¢–µ—Å—Ç –ø—Ä–æ–≤–µ—Ä—è–µ—Ç:
- ‚úÖ –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π
- ‚úÖ –ë–ª–æ–∫–∏—Ä–æ–≤–∫—É –¥–æ—Å—Ç—É–ø–∞ –±–µ–∑ –ø–æ–¥–ø–∏—Å–∫–∏
- ‚úÖ –ö–æ—Ä—Ä–µ–∫—Ç–Ω—É—é —Ä–∞–±–æ—Ç—É —Ç—Ä–∏–∞–ª–∞ –∏ –ø–ª–∞—Ç–Ω—ã—Ö –ø–ª–∞–Ω–æ–≤
- ‚úÖ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—é –∞–¥–º–∏–Ω –ø–∞–Ω–µ–ª–∏ –∏ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –±–æ—Ç–∞

## üöÄ –°—Ç–∞—Ç—É—Å —Å–∏—Å—Ç–µ–º—ã

### ‚úÖ –ß—Ç–æ —Ä–∞–±–æ—Ç–∞–µ—Ç:
- üîê –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –±–ª–æ–∫–∏—Ä–æ–≤–∫–∞ –¥–æ—Å—Ç—É–ø–∞
- üë§ –ê–≤—Ç–æ—Å–æ–∑–¥–∞–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π –ø—Ä–∏ `/start`
- üí≥ –ü–æ–ª–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ç–∞—Ä–∏—Ñ–æ–≤
- üéõÔ∏è –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –∞–Ω–∞–ª–∏—Ç–∏–∫–∞
- üîÑ –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤—Å–µ—Ö –∫–æ–º–ø–æ–Ω–µ–Ω—Ç–æ–≤

### üîß –ó–∞–ø—É—â–µ–Ω–Ω—ã–µ —Å–µ—Ä–≤–∏—Å—ã:
- ‚úÖ –û—Å–Ω–æ–≤–Ω–æ–π Telegram –±–æ—Ç (main.py)
- ‚úÖ –ê–¥–º–∏–Ω –±–æ—Ç (test_admin_bot.py)
- ‚úÖ Database Connection Pool
- ‚úÖ Instagram Client Pool
- ‚úÖ IMAP Pool
- ‚úÖ Structured Logging —Å Sampling

## üìû –ü–æ–¥–¥–µ—Ä–∂–∫–∞

**–î–ª—è –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ–π:**
- –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–æ—Å—Ç—É–ø–∞: `@admin`
- –¢–µ—Ö–Ω–∏—á–µ—Å–∫–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞: –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–∏—Ç—å Telegram ID

**–î–ª—è –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä–æ–≤:**
- –ê–¥–º–∏–Ω –ø–∞–Ω–µ–ª—å: `@reelsadmin_bot`
- –ö–æ–º–∞–Ω–¥—ã: `/start`, `/stats`, `/help`

---

## üéØ –ê–ª–≥–æ—Ä–∏—Ç–º —Ä–∞–±–æ—Ç—ã —Å –∫–ª–∏–µ–Ω—Ç–∞–º–∏

1. **–ö–ª–∏–µ–Ω—Ç –Ω–∞–∂–∏–º–∞–µ—Ç /start** ‚Üí –≤–∏–¥–∏—Ç —Å–≤–æ–π ID –∏ –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏
2. **–ö–ª–∏–µ–Ω—Ç –≤—ã–±–∏—Ä–∞–µ—Ç —Ç–∞—Ä–∏—Ñ** ‚Üí —Å–≤—è–∑—ã–≤–∞–µ—Ç—Å—è —Å –∞–¥–º–∏–Ω–æ–º
3. **–ê–¥–º–∏–Ω –ø–æ–ª—É—á–∞–µ—Ç –æ–ø–ª–∞—Ç—É** ‚Üí –∞–∫—Ç–∏–≤–∏—Ä—É–µ—Ç —á–µ—Ä–µ–∑ –∞–¥–º–∏–Ω-–±–æ—Ç
4. **–ö–ª–∏–µ–Ω—Ç –ø–æ–ª—É—á–∞–µ—Ç –¥–æ—Å—Ç—É–ø** ‚Üí –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –≤—Å–µ —Ñ—É–Ω–∫—Ü–∏–∏ –±–æ—Ç–∞
5. **–°–∏—Å—Ç–µ–º–∞ –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏** ‚Üí –∫–æ–Ω—Ç—Ä–æ–ª–∏—Ä—É–µ—Ç —Å—Ä–æ–∫–∏ –∏ –±–ª–æ–∫–∏—Ä—É–µ—Ç –ø—Ä–∏ –∏—Å—Ç–µ—á–µ–Ω–∏–∏

**–†–µ–∑—É–ª—å—Ç–∞—Ç:** –ü–æ–ª–Ω–æ—Å—Ç—å—é –∞–≤—Ç–æ–º–∞—Ç–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ –º–æ–Ω–µ—Ç–∏–∑–∞—Ü–∏–∏ —Å –º–∏–Ω–∏–º–∞–ª—å–Ω—ã–º–∏ —Ä—É—á–Ω—ã–º–∏ –æ–ø–µ—Ä–∞—Ü–∏—è–º–∏! 